<!doctype html>
<html lang="vi">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Career Path Quiz Game Pro</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Poppins', 'Inter', 'Nunito', sans-serif;
      background: linear-gradient(135deg, #ff0080 0%, #7928ca 50%, #0070f3 100%);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      min-height: 100%;
      width: 100%;
      overflow-x: hidden;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    * {
      box-sizing: border-box;
    }

    .background-pattern {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 20% 50%, rgba(255, 0, 255, 0.2) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.2) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(255, 255, 0, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 60% 60%, rgba(0, 255, 128, 0.15) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
      animation: patternPulse 8s ease-in-out infinite;
    }

    @keyframes patternPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    
    .game-container {
      position: relative;
      width: 100%;
      min-height: 100%;
      padding: 30px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 1;
    }
    
    .game-card {
      background: rgba(20, 20, 40, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 32px;
      padding: 40px;
      max-width: 1000px;
      width: 100%;
      box-shadow: 
        0 0 80px rgba(255, 0, 255, 0.3),
        0 0 120px rgba(0, 255, 255, 0.2),
        0 25px 80px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
      animation: slideInUp 0.6s ease-out, cardGlow 3s ease-in-out infinite;
      border: 2px solid rgba(255, 255, 255, 0.1);
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes cardGlow {
      0%, 100% {
        box-shadow: 
          0 0 80px rgba(255, 0, 255, 0.3),
          0 0 120px rgba(0, 255, 255, 0.2),
          0 25px 80px rgba(0, 0, 0, 0.5);
      }
      50% {
        box-shadow: 
          0 0 100px rgba(255, 0, 255, 0.5),
          0 0 140px rgba(0, 255, 255, 0.3),
          0 25px 80px rgba(0, 0, 0, 0.5);
      }
    }

    .game-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: linear-gradient(90deg, #ff0080, #ff00ff, #00ffff, #00ff88, #ffff00, #ff0080);
      background-size: 200% 100%;
      animation: gradientShift 3s linear infinite;
      box-shadow: 0 0 20px rgba(255, 0, 255, 0.8);
    }

    @keyframes gradientShift {
      0% { background-position: 0% 0%; }
      100% { background-position: 200% 0%; }
    }
    
    .game-header {
      text-align: center;
      margin-bottom: 35px;
    }
    
    .game-title {
      font-size: 42px;
      font-weight: 900;
      background: linear-gradient(135deg, #ff00ff 0%, #00ffff 50%, #ffff00 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      background-size: 200% 200%;
      animation: titleGradient 3s ease infinite;
      margin: 0 0 12px 0;
      text-shadow: 
        0 0 30px rgba(255, 0, 255, 0.6),
        0 0 60px rgba(0, 255, 255, 0.4);
      filter: drop-shadow(0 0 10px rgba(255, 0, 255, 0.8));
    }

    @keyframes titleGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    .game-subtitle {
      font-size: 18px;
      color: #a0aec0;
      margin: 0;
      font-weight: 600;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    }

    /* Team Selection Screen */
    .team-selection {
      display: block;
    }

    .team-selection.hidden {
      display: none;
    }

    .selection-instruction {
      text-align: center;
      font-size: 20px;
      color: #2d3748;
      margin-bottom: 30px;
      font-weight: 600;
    }

    .careers-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .career-card {
      background: rgba(30, 30, 60, 0.8);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 0, 255, 0.3);
      border-radius: 20px;
      padding: 25px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
    }

    .career-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 0, 255, 0.3), transparent);
      transition: left 0.5s ease;
    }

    .career-card:hover::before {
      left: 100%;
    }

    .career-card:hover {
      transform: translateY(-10px) scale(1.03);
      border-color: #ff00ff;
      box-shadow: 
        0 0 40px rgba(255, 0, 255, 0.6),
        0 15px 40px rgba(0, 0, 0, 0.4);
    }

    .career-card.selected {
      border-color: #00ffff;
      border-width: 3px;
      transform: scale(1.08);
      box-shadow: 
        0 0 60px rgba(0, 255, 255, 0.8),
        0 20px 50px rgba(0, 0, 0, 0.5);
      animation: selectPulse 0.5s ease;
      background: rgba(0, 255, 255, 0.1);
    }

    @keyframes selectPulse {
      0%, 100% { transform: scale(1.08); }
      50% { transform: scale(1.12); }
    }

    .career-card.taken {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
      filter: grayscale(1);
    }

    /* Career Themes */
    .career-card[data-theme="doctor"] {
      background: linear-gradient(135deg, #e8f5f7 0%, #d4eef2 100%);
      border-color: #6dd5ed;
    }

    .career-card[data-theme="programmer"] {
      background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
      border-color: #4299e1;
    }

    .career-card[data-theme="programmer"] .career-name,
    .career-card[data-theme="programmer"] .career-desc {
      color: #ffffff !important;
    }

    .career-card[data-theme="content-creator"] {
      background: linear-gradient(135deg, #ffe5f1 0%, #ffc9e3 100%);
      border-color: #ff6b9d;
    }

    .career-card[data-theme="salesperson"] {
      background: linear-gradient(135deg, #e6f7ff 0%, #ccedff 100%);
      border-color: #1890ff;
    }

    .career-card[data-theme="manager"] {
      background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
      border-color: #9c27b0;
    }

    .career-card[data-theme="businessperson"] {
      background: linear-gradient(135deg, #fff9e6 0%, #fff3cc 100%);
      border-color: #ffc107;
    }

    .career-icon {
      font-size: 56px;
      margin-bottom: 15px;
      display: block;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    .career-name {
      font-size: 22px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    .career-card.selected .career-name {
      color: #00ffff;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
    }

    .career-desc {
      font-size: 14px;
      color: #a0aec0;
      font-weight: 500;
    }

    .career-card.selected .career-desc {
      color: #ffffff;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    /* Home Screen */
    .home-screen {
      display: block;
      text-align: center;
    }

    .home-screen.hidden {
      display: none;
    }

    .welcome-icon {
      font-size: 120px;
      margin-bottom: 20px;
      animation: float 3s ease-in-out infinite;
    }

    .home-title {
      font-size: 48px;
      font-weight: 900;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 15px;
    }

    .home-description {
      font-size: 20px;
      color: #718096;
      margin-bottom: 40px;
      line-height: 1.6;
      font-weight: 500;
    }

    .game-features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .feature-card {
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
    }

    .feature-card:hover {
      transform: translateY(-5px);
      border-color: #667eea;
      box-shadow: 0 10px 25px rgba(102, 126, 234, 0.2);
    }

    .feature-icon {
      font-size: 40px;
      margin-bottom: 10px;
    }

    .feature-title {
      font-size: 18px;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 5px;
    }

    .feature-desc {
      font-size: 14px;
      color: #718096;
    }

    .start-button {
      width: 100%;
      padding: 22px;
      background: linear-gradient(135deg, #ff0080 0%, #ff00ff 50%, #00ffff 100%);
      background-size: 200% 200%;
      animation: buttonGradient 3s ease infinite;
      color: #ffffff;
      border: none;
      border-radius: 16px;
      font-size: 24px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 
        0 0 30px rgba(255, 0, 255, 0.6),
        0 8px 25px rgba(255, 0, 128, 0.4);
      text-transform: uppercase;
      letter-spacing: 3px;
      position: relative;
      overflow: hidden;
    }

    @keyframes buttonGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .start-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s ease;
    }

    .start-button:hover::before {
      left: 100%;
    }

    .start-button:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 
        0 0 50px rgba(255, 0, 255, 0.8),
        0 12px 40px rgba(255, 0, 128, 0.6);
    }

    .team-info {
      background: linear-gradient(135deg, #edf2f7 0%, #e2e8f0 100%);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 25px;
      text-align: center;
    }

    .team-label {
      font-size: 16px;
      color: #718096;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .team-name-display {
      font-size: 28px;
      font-weight: 800;
      color: #667eea;
      margin-bottom: 5px;
    }

    /* Team Name Input */
    .team-name-section {
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 25px;
    }

    .team-name-label {
      font-size: 18px;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 15px;
      text-align: center;
    }

    .team-name-input {
      width: 100%;
      padding: 15px;
      font-size: 18px;
      font-weight: 600;
      border: 3px solid #e2e8f0;
      border-radius: 10px;
      text-align: center;
      transition: all 0.3s ease;
      background: #ffffff;
      color: #2d3748;
    }

    .team-name-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }

    .team-counter {
      text-align: center;
      font-size: 16px;
      color: #718096;
      margin-top: 10px;
      font-weight: 600;
    }

    .confirm-button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      color: #ffffff;
      border: none;
      border-radius: 12px;
      font-size: 20px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(72, 187, 120, 0.3);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .confirm-button:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(72, 187, 120, 0.4);
    }

    .confirm-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Quiz Screen */
    .quiz-screen {
      display: none;
    }

    .quiz-screen.active {
      display: block;
    }

    .current-team-banner {
      background: linear-gradient(135deg, #ff0080 0%, #ff00ff 50%, #7928ca 100%);
      background-size: 200% 200%;
      animation: slideInRight 0.5s ease-out, bannerGradient 3s ease infinite;
      color: #ffffff;
      padding: 20px;
      border-radius: 20px;
      text-align: center;
      margin-bottom: 25px;
      box-shadow: 
        0 0 50px rgba(255, 0, 255, 0.6),
        0 10px 30px rgba(0, 0, 0, 0.4);
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    /* Game Host - Cat Character */
    .game-host {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 100;
      animation: hostFloat 3s ease-in-out infinite;
    }

    .host-character {
      font-size: 80px;
      filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.3));
      animation: hostBounce 2s ease-in-out infinite;
    }

    .host-speech-bubble {
      position: absolute;
      bottom: 100%;
      right: 0;
      background: white;
      color: #2d3748;
      padding: 12px 18px;
      border-radius: 16px;
      font-size: 14px;
      font-weight: 700;
      white-space: nowrap;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
      margin-bottom: 10px;
      display: none;
      animation: bubblePop 0.3s ease-out;
    }

    .host-speech-bubble.show {
      display: block;
    }

    .host-speech-bubble::after {
      content: '';
      position: absolute;
      bottom: -10px;
      right: 20px;
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-top: 10px solid white;
    }

    @keyframes hostFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }

    @keyframes hostBounce {
      0%, 100% { transform: scale(1) rotate(-5deg); }
      50% { transform: scale(1.1) rotate(5deg); }
    }

    @keyframes bubblePop {
      0% { transform: scale(0); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }

    /* Career Character Display */
    .character-display {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
      position: relative;
    }

    .career-character {
      font-size: 120px;
      animation: characterIdle 2s ease-in-out infinite;
      filter: drop-shadow(0 10px 25px rgba(0, 0, 0, 0.3));
      position: relative;
    }

    .character-display.sweating .career-character {
      animation: characterSweat 0.3s ease-in-out infinite;
    }

    .character-display.correct .career-character {
      animation: characterCelebrate 0.6s ease-in-out;
    }

    .character-display.wrong .career-character {
      animation: characterSad 0.6s ease-in-out;
    }

    @keyframes characterIdle {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-10px) rotate(3deg); }
    }

    @keyframes characterSweat {
      0%, 100% { transform: translateX(0) rotate(-2deg); }
      25% { transform: translateX(-5px) rotate(-5deg); }
      75% { transform: translateX(5px) rotate(5deg); }
    }

    @keyframes characterCelebrate {
      0%, 100% { transform: scale(1) rotate(0deg); }
      25% { transform: scale(1.2) rotate(-10deg); }
      50% { transform: scale(1.3) rotate(10deg); }
      75% { transform: scale(1.2) rotate(-5deg); }
    }

    @keyframes characterSad {
      0% { transform: translateY(0) rotate(0deg); }
      25% { transform: translateY(10px) rotate(-5deg); }
      50% { transform: translateY(5px) rotate(5deg); }
      75% { transform: translateY(15px) rotate(-3deg); }
      100% { transform: translateY(20px) rotate(0deg); }
    }

    /* Sweat Drops */
    .sweat-drop {
      position: absolute;
      font-size: 30px;
      animation: sweatFall 0.8s ease-in infinite;
      opacity: 0;
    }

    .sweat-drop:nth-child(1) {
      top: 20%;
      left: 30%;
      animation-delay: 0s;
    }

    .sweat-drop:nth-child(2) {
      top: 25%;
      right: 30%;
      animation-delay: 0.3s;
    }

    .sweat-drop:nth-child(3) {
      top: 35%;
      left: 25%;
      animation-delay: 0.6s;
    }

    @keyframes sweatFall {
      0% { opacity: 0; transform: translateY(0); }
      20% { opacity: 1; }
      100% { opacity: 0; transform: translateY(80px); }
    }

    /* Emotion Effects */
    .emotion-particle {
      position: absolute;
      font-size: 40px;
      animation: emotionFloat 1s ease-out forwards;
      pointer-events: none;
    }

    @keyframes emotionFloat {
      0% {
        opacity: 1;
        transform: translate(0, 0) scale(0.5);
      }
      100% {
        opacity: 0;
        transform: translate(var(--tx), var(--ty)) scale(1.5);
      }
    }

    @keyframes bannerGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .current-team-banner h2 {
      margin: 0 0 8px 0;
      font-size: 28px;
      font-weight: 800;
    }

    .current-team-banner p {
      margin: 0;
      font-size: 18px;
      opacity: 0.95;
    }

    .question-counter {
      text-align: center;
      font-size: 18px;
      color: #718096;
      margin-bottom: 20px;
      font-weight: 600;
    }

    /* Power-ups Section */
    .powerups-section {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .powerup-button {
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: #ffffff;
      border: none;
      border-radius: 10px;
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3);
    }

    .powerup-button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(251, 191, 36, 0.4);
    }

    .powerup-button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
      transform: none;
    }

    .powerup-button.used {
      background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
      opacity: 0.5;
    }

    /* Answer Timer */
    .discussion-timer {
      display: none;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: #ffffff;
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      margin-bottom: 20px;
      font-size: 20px;
      font-weight: 800;
      animation: timerPulse 1s ease-in-out infinite;
      transition: background 0.3s ease;
    }

    .discussion-timer.active {
      display: block;
    }

    .discussion-timer.warning {
      background: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%);
      animation: timerPulse 0.5s ease-in-out infinite;
    }

    .discussion-timer.danger {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      animation: timerPulse 0.3s ease-in-out infinite;
    }

    @keyframes timerPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .question-box {
      background: rgba(30, 30, 60, 0.8);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 25px;
      border: 2px solid rgba(255, 0, 255, 0.4);
      animation: slideInLeft 0.5s ease-out;
      box-shadow: 
        0 0 40px rgba(255, 0, 255, 0.3),
        0 10px 30px rgba(0, 0, 0, 0.3);
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .question-text {
      font-size: 24px;
      font-weight: 700;
      color: #ffffff;
      margin: 0;
      line-height: 1.5;
      text-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
    }

    .bonus-indicator {
      display: inline-block;
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: #ffffff;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 800;
      margin-left: 10px;
      animation: bonusPulse 1s ease-in-out infinite;
    }

    @keyframes bonusPulse {
      0%, 100% { transform: scale(1); box-shadow: 0 0 0 rgba(251, 191, 36, 0.7); }
      50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(251, 191, 36, 0.7); }
    }

    .answers-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 25px;
    }

    .answer-button {
      background: rgba(40, 40, 80, 0.6);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 0, 255, 0.3);
      border-radius: 16px;
      padding: 20px;
      font-size: 17px;
      font-weight: 600;
      color: #ffffff;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      position: relative;
      overflow: hidden;
    }

    .answer-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255, 0, 255, 0.2), rgba(0, 255, 255, 0.2));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .answer-button:hover::before {
      opacity: 1;
    }

    .answer-button:hover {
      border-color: #ff00ff;
      transform: translateX(8px);
      box-shadow: 0 0 30px rgba(255, 0, 255, 0.5);
    }

    .answer-button.selected {
      background: linear-gradient(135deg, #ff0080 0%, #ff00ff 50%, #00ffff 100%);
      background-size: 200% 200%;
      animation: answerGradient 2s ease infinite;
      border-color: #00ffff;
      border-width: 3px;
      color: #ffffff;
      transform: scale(1.03);
      box-shadow: 0 0 40px rgba(0, 255, 255, 0.6);
    }

    @keyframes answerGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .answer-button.correct {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      border-color: #48bb78;
      color: #ffffff;
      animation: correctPulse 0.6s ease;
    }

    .answer-button.wrong {
      background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
      border-color: #f56565;
      color: #ffffff;
      animation: wrongShake 0.5s ease;
    }

    .answer-button.eliminated {
      opacity: 0.3;
      pointer-events: none;
      text-decoration: line-through;
    }

    @keyframes correctPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes wrongShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    .submit-answer-button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #00ff88 0%, #00ffff 100%);
      background-size: 200% 200%;
      animation: submitGradient 2s ease infinite;
      color: #000000;
      border: none;
      border-radius: 16px;
      font-size: 20px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 
        0 0 30px rgba(0, 255, 255, 0.5),
        0 6px 20px rgba(0, 255, 136, 0.4);
      text-transform: uppercase;
      letter-spacing: 2px;
      position: relative;
      overflow: hidden;
    }

    @keyframes submitGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .submit-answer-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
      transition: left 0.5s ease;
    }

    .submit-answer-button:hover:not(:disabled)::before {
      left: 100%;
    }

    .submit-answer-button:hover:not(:disabled) {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 
        0 0 50px rgba(0, 255, 255, 0.8),
        0 10px 35px rgba(0, 255, 136, 0.6);
    }

    .submit-answer-button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      animation: none;
    }

    /* Live Leaderboard */
    .live-leaderboard {
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 25px;
      border: 2px solid #e2e8f0;
    }

    .leaderboard-title {
      font-size: 18px;
      font-weight: 800;
      color: #2d3748;
      margin-bottom: 15px;
      text-align: center;
    }

    .leaderboard-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .leaderboard-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 15px;
      background: #ffffff;
      border-radius: 8px;
      border: 2px solid #e2e8f0;
      transition: all 0.3s ease;
    }

    .leaderboard-item.current {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      transform: scale(1.02);
    }

    .leaderboard-team {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      color: #2d3748;
    }

    .leaderboard-rank {
      font-size: 18px;
      font-weight: 800;
      color: #667eea;
      min-width: 25px;
    }

    .leaderboard-score {
      font-size: 18px;
      font-weight: 800;
      color: #48bb78;
    }

    /* Scoreboard */
    .scoreboard-screen {
      display: none;
    }

    .scoreboard-screen.active {
      display: block;
    }

    .scoreboard-title {
      text-align: center;
      font-size: 38px;
      font-weight: 900;
      color: #2d3748;
      margin-bottom: 25px;
      animation: slideInUp 0.6s ease-out;
    }

    .awards-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .award-badge {
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: #ffffff;
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 6px 20px rgba(251, 191, 36, 0.3);
      animation: awardSlideIn 0.6s ease-out;
    }

    @keyframes awardSlideIn {
      from {
        opacity: 0;
        transform: scale(0.8);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .award-icon {
      font-size: 36px;
      margin-bottom: 8px;
    }

    .award-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .award-winner {
      font-size: 16px;
      font-weight: 800;
    }

    .scores-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 30px;
    }

    .score-item {
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      border: 3px solid #e2e8f0;
      border-radius: 16px;
      padding: 20px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
      animation: scoreSlideIn 0.5s ease-out;
    }

    @keyframes scoreSlideIn {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .score-item.rank-1 {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      border-color: #ffd700;
      transform: scale(1.05);
      box-shadow: 0 15px 40px rgba(255, 215, 0, 0.4);
      animation: winnerGlow 2s ease-in-out infinite;
    }

    @keyframes winnerGlow {
      0%, 100% { box-shadow: 0 15px 40px rgba(255, 215, 0, 0.4); }
      50% { box-shadow: 0 20px 50px rgba(255, 215, 0, 0.6); }
    }

    .score-item.rank-2 {
      background: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 100%);
      border-color: #c0c0c0;
      transform: scale(1.02);
    }

    .score-item.rank-3 {
      background: linear-gradient(135deg, #cd7f32 0%, #e8a87c 100%);
      border-color: #cd7f32;
    }

    .score-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .rank-badge {
      font-size: 28px;
      font-weight: 900;
      width: 50px;
      height: 50px;
      background: #667eea;
      color: #ffffff;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .score-item.rank-1 .rank-badge {
      background: #2d3748;
      font-size: 32px;
    }

    .score-item.rank-2 .rank-badge {
      background: #4a5568;
    }

    .score-item.rank-3 .rank-badge {
      background: #744210;
    }

    .team-details {
      display: flex;
      flex-direction: column;
    }

    .team-name-score {
      font-size: 22px;
      font-weight: 700;
      color: #2d3748;
    }

    .career-name-score {
      font-size: 15px;
      color: #718096;
      font-weight: 600;
    }

    .score-points {
      font-size: 32px;
      font-weight: 900;
      color: #667eea;
    }

    .score-item.rank-1 .score-points {
      color: #2d3748;
      font-size: 38px;
    }

    .winner-message {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      color: #ffffff;
      padding: 25px;
      border-radius: 16px;
      text-align: center;
      margin-bottom: 25px;
      font-size: 24px;
      font-weight: 700;
      box-shadow: 0 10px 30px rgba(72, 187, 120, 0.3);
      animation: winnerPulse 1.5s ease-in-out infinite;
    }

    @keyframes winnerPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    .fireworks {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
    }

    .firework {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: explode 1.5s ease-out forwards;
    }

    @keyframes explode {
      0% {
        transform: translate(0, 0) scale(1);
        opacity: 1;
      }
      100% {
        transform: translate(var(--tx), var(--ty)) scale(0);
        opacity: 0;
      }
    }

    .restart-game-button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
      border: none;
      border-radius: 12px;
      font-size: 20px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .restart-game-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }

    /* Lucky Boxes Screen */
    .lucky-boxes-screen {
      display: none;
    }

    .lucky-boxes-screen.active {
      display: block;
    }

    .lucky-banner {
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #ea580c 100%);
      background-size: 200% 200%;
      animation: bannerGradient 3s ease infinite;
      color: #ffffff;
      padding: 25px;
      border-radius: 20px;
      text-align: center;
      margin-bottom: 25px;
      box-shadow: 
        0 0 50px rgba(251, 191, 36, 0.6),
        0 10px 30px rgba(0, 0, 0, 0.4);
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .lucky-banner h2 {
      margin: 0 0 10px 0;
      font-size: 32px;
      font-weight: 900;
    }

    .lucky-banner p {
      margin: 0;
      font-size: 18px;
      opacity: 0.95;
    }

    .boxes-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 15px;
      margin-bottom: 25px;
    }

    .lucky-box {
      aspect-ratio: 1;
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.2) 0%, rgba(245, 158, 11, 0.2) 100%);
      backdrop-filter: blur(10px);
      border: 3px solid rgba(251, 191, 36, 0.4);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .lucky-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s ease;
    }

    .lucky-box:hover::before {
      left: 100%;
    }

    .lucky-box:hover {
      transform: translateY(-10px) scale(1.05);
      border-color: #fbbf24;
      box-shadow: 
        0 0 40px rgba(251, 191, 36, 0.8),
        0 15px 40px rgba(0, 0, 0, 0.4);
    }

    .lucky-box.opened {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
      filter: grayscale(1);
    }

    .box-icon {
      font-size: 48px;
      margin-bottom: 10px;
      animation: float 3s ease-in-out infinite;
    }

    .box-number {
      font-size: 20px;
      font-weight: 800;
      color: #fbbf24;
      text-shadow: 0 0 10px rgba(251, 191, 36, 0.8);
    }

    /* Lucky Box Quiz Modal */
    .lucky-quiz-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(10px);
      z-index: 10002;
      align-items: center;
      justify-content: center;
    }

    .lucky-quiz-modal.show {
      display: flex;
    }

    .lucky-quiz-content {
      background: linear-gradient(135deg, rgba(20, 20, 40, 0.98) 0%, rgba(30, 30, 60, 0.98) 100%);
      backdrop-filter: blur(20px);
      border-radius: 32px;
      padding: 50px;
      max-width: 700px;
      width: 90%;
      max-height: 85%;
      overflow-y: auto;
      border: 3px solid rgba(251, 191, 36, 0.5);
      box-shadow: 0 0 80px rgba(251, 191, 36, 0.6);
      animation: modalPopIn 0.5s ease-out;
    }

    @keyframes modalPopIn {
      from {
        opacity: 0;
        transform: scale(0.5);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .quiz-modal-title {
      font-size: 28px;
      font-weight: 900;
      color: #fbbf24;
      text-align: center;
      margin-bottom: 25px;
      text-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
    }

    .quiz-modal-question {
      font-size: 20px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 25px;
      line-height: 1.6;
      text-align: center;
    }

    .quiz-modal-answers {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 25px;
    }

    .quiz-answer-button {
      background: rgba(40, 40, 80, 0.6);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 0, 255, 0.3);
      border-radius: 16px;
      padding: 18px;
      font-size: 16px;
      font-weight: 600;
      color: #ffffff;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
    }

    .quiz-answer-button:hover {
      border-color: #ff00ff;
      transform: translateX(8px);
      box-shadow: 0 0 30px rgba(255, 0, 255, 0.5);
    }

    .quiz-answer-button.selected {
      background: linear-gradient(135deg, #ff0080 0%, #ff00ff 50%, #00ffff 100%);
      border-color: #00ffff;
      border-width: 3px;
    }

    .quiz-answer-button.correct {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      border-color: #48bb78;
    }

    .quiz-answer-button.wrong {
      background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
      border-color: #f56565;
    }

    .quiz-submit-button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: #000000;
      border: none;
      border-radius: 16px;
      font-size: 20px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(251, 191, 36, 0.4);
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .quiz-submit-button:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(251, 191, 36, 0.6);
    }

    .quiz-submit-button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    /* Lucky Box Result Modal */
    .lucky-result-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      z-index: 10000;
      align-items: center;
      justify-content: center;
    }

    .lucky-result-modal.show {
      display: flex;
    }

    .lucky-result-content {
      background: linear-gradient(135deg, rgba(20, 20, 40, 0.98) 0%, rgba(30, 30, 60, 0.98) 100%);
      backdrop-filter: blur(20px);
      border-radius: 32px;
      padding: 50px;
      max-width: 600px;
      width: 90%;
      text-align: center;
      border: 3px solid rgba(251, 191, 36, 0.5);
      box-shadow: 0 0 80px rgba(251, 191, 36, 0.6);
      animation: modalPopIn 0.5s ease-out;
    }

    .result-icon {
      font-size: 120px;
      margin-bottom: 20px;
      animation: iconSpin 1s ease-out;
    }

    @keyframes iconSpin {
      from {
        transform: rotate(0deg) scale(0);
      }
      to {
        transform: rotate(360deg) scale(1);
      }
    }

    .result-title {
      font-size: 36px;
      font-weight: 900;
      color: #fbbf24;
      margin-bottom: 15px;
      text-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
    }

    .result-description {
      font-size: 20px;
      color: #ffffff;
      margin-bottom: 30px;
      line-height: 1.6;
    }

    .result-action-button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: #000000;
      border: none;
      border-radius: 16px;
      font-size: 20px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(251, 191, 36, 0.4);
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .result-action-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(251, 191, 36, 0.6);
    }

    /* Team Selector Modal */
    .team-selector-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      z-index: 10001;
      align-items: center;
      justify-content: center;
    }

    .team-selector-modal.show {
      display: flex;
    }

    .team-selector-content {
      background: linear-gradient(135deg, rgba(20, 20, 40, 0.98) 0%, rgba(30, 30, 60, 0.98) 100%);
      backdrop-filter: blur(20px);
      border-radius: 32px;
      padding: 40px;
      max-width: 600px;
      width: 90%;
      max-height: 80%;
      overflow-y: auto;
      border: 3px solid rgba(255, 0, 255, 0.5);
      box-shadow: 0 0 80px rgba(255, 0, 255, 0.6);
    }

    .team-selector-title {
      font-size: 28px;
      font-weight: 900;
      color: #00ffff;
      margin-bottom: 25px;
      text-align: center;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
    }

    .team-select-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .team-select-button {
      background: rgba(40, 40, 80, 0.6);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 0, 255, 0.3);
      border-radius: 16px;
      padding: 20px;
      font-size: 18px;
      font-weight: 700;
      color: #ffffff;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .team-select-button:hover {
      border-color: #ff00ff;
      transform: translateX(8px);
      box-shadow: 0 0 30px rgba(255, 0, 255, 0.5);
      background: linear-gradient(135deg, rgba(255, 0, 255, 0.2), rgba(0, 255, 255, 0.2));
    }

    /* Notification Toast */
    .notification-toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
      padding: 15px 25px;
      border-radius: 12px;
      font-weight: 700;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      z-index: 10000;
      animation: toastSlideIn 0.5s ease-out;
      display: none;
    }

    .notification-toast.show {
      display: block;
    }

    @keyframes toastSlideIn {
      from {
        opacity: 0;
        transform: translateX(100px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @media (max-width: 768px) {
      .game-card {
        padding: 25px;
      }

      .game-title {
        font-size: 32px;
      }

      .careers-grid {
        grid-template-columns: 1fr;
      }

      .answers-grid {
        grid-template-columns: 1fr;
      }

      .question-text {
        font-size: 20px;
      }

      .powerups-section {
        flex-direction: column;
      }

      .awards-section {
        grid-template-columns: 1fr;
      }

      .boxes-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .lucky-result-content, .lucky-quiz-content {
        padding: 30px;
      }

      .result-icon {
        font-size: 80px;
      }

      .result-title {
        font-size: 28px;
      }

      .team-selector-content {
        padding: 25px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="background-pattern"></div>
  <div class="notification-toast" id="notificationToast"></div><!-- Game Host Cat -->
  <div class="game-host" id="gameHost">
   <div class="host-speech-bubble" id="hostSpeech"></div>
   <div class="host-character">
    üê±üé©
   </div>
  </div>
  <main class="game-container">
   <div class="game-card">
    <div class="game-header">
     <h1 class="game-title" id="gameTitle">üéÆ Career Path Quiz Game Pro</h1>
     <p class="game-subtitle" id="instructionText">6 Teams ‚Ä¢ 6 Careers ‚Ä¢ 5 Questions + Bonus</p>
    </div><!-- Home Screen -->
    <div class="home-screen" id="homeScreen">
     <div class="welcome-icon">
      üéØ
     </div>
     <h2 class="home-title">Welcome to Career Path Quiz!</h2>
     <p class="home-description">Test your knowledge across 6 different career paths.<br>
       Compete with your teams and become the champion!</p>
     <div class="game-features">
      <div class="feature-card">
       <div class="feature-icon">
        üë•
       </div>
       <div class="feature-title">
        6 Teams
       </div>
       <div class="feature-desc">
        Each team chooses their career
       </div>
      </div>
      <div class="feature-card">
       <div class="feature-icon">
        üíº
       </div>
       <div class="feature-title">
        6 Careers
       </div>
       <div class="feature-desc">
        Unique questions for each path
       </div>
      </div>
      <div class="feature-card">
       <div class="feature-icon">
        ‚ö°
       </div>
       <div class="feature-title">
        Power-ups
       </div>
       <div class="feature-desc">
        50/50 &amp; Double Points
       </div>
      </div>
      <div class="feature-card">
       <div class="feature-icon">
        ‚è±Ô∏è
       </div>
       <div class="feature-title">
        30 Seconds
       </div>
       <div class="feature-desc">
        Answer fast to score!
       </div>
      </div>
     </div><button class="start-button" onclick="goToTeamSetup()"> üöÄ Start Game </button>
    </div><!-- Team Selection Screen -->
    <div class="team-selection hidden" id="teamSelection">
     <div class="team-name-section">
      <div class="team-name-label">
       Enter Your Team Name:
      </div><input type="text" class="team-name-input" id="teamNameInput" placeholder="Type team name here..." maxlength="20" oninput="validateTeamName()">
      <div class="team-counter" id="teamCounter">
       Team 1 of 6
      </div>
     </div>
     <p class="selection-instruction">Choose your career path:</p>
     <div class="careers-grid" id="careersGrid"></div><button class="confirm-button" id="confirmButton" disabled onclick="confirmSelection()"> Start Quiz ‚Üí </button>
    </div><!-- Quiz Screen -->
    <div class="quiz-screen" id="quizScreen">
     <div class="current-team-banner">
      <h2 id="quizTeamName">Team 1</h2>
      <p id="quizCareerName">Doctor</p>
     </div><!-- Career Character Display -->
     <div class="character-display" id="characterDisplay">
      <div class="career-character" id="careerCharacter">
       üë®‚Äç‚öïÔ∏è
      </div>
     </div><!-- Live Leaderboard -->
     <div class="live-leaderboard">
      <div class="leaderboard-title">
       üìä Current Standings
      </div>
      <div class="leaderboard-list" id="leaderboardList"></div>
     </div><!-- Power-ups -->
     <div class="powerups-section"><button class="powerup-button" id="fiftyFiftyBtn" onclick="useFiftyFifty()"> ‚ö° 50/50 </button> <button class="powerup-button" id="doublePointsBtn" onclick="useDoublePoints()"> üíé Double Points </button>
     </div><!-- Answer Timer -->
     <div class="discussion-timer active" id="answerTimer">
      ‚è±Ô∏è Time Remaining: <span id="timerSeconds">30</span>s
     </div>
     <div class="question-counter" id="questionCounter">
      Question 1 of 5
     </div>
     <div class="question-box">
      <p class="question-text" id="questionText"></p>
     </div>
     <div class="answers-grid" id="answersGrid"></div><button class="submit-answer-button" id="submitButton" disabled onclick="submitAnswer()"> Submit Answer </button>
    </div><!-- Lucky Boxes Screen -->
    <div class="lucky-boxes-screen" id="luckyBoxesScreen">
     <div class="lucky-banner">
      <h2 id="luckyTeamName">üé∞ Team Name's Turn</h2>
      <p>Answer the question to open your lucky box!</p>
     </div><!-- Live Leaderboard -->
     <div class="live-leaderboard">
      <div class="leaderboard-title">
       üìä Current Standings
      </div>
      <div class="leaderboard-list" id="luckyLeaderboardList"></div>
     </div>
     <div class="boxes-grid" id="boxesGrid"></div>
    </div><!-- Lucky Box Quiz Modal -->
    <div class="lucky-quiz-modal" id="luckyQuizModal">
     <div class="lucky-quiz-content">
      <div class="quiz-modal-title">
       üéì Career Future Question
      </div>
      <div class="quiz-modal-question" id="quizModalQuestion"></div>
      <div class="quiz-modal-answers" id="quizModalAnswers"></div><button class="quiz-submit-button" id="quizSubmitButton" disabled onclick="submitLuckyQuizAnswer()"> Submit Answer </button>
     </div>
    </div><!-- Lucky Result Modal -->
    <div class="lucky-result-modal" id="luckyResultModal">
     <div class="lucky-result-content">
      <div class="result-icon" id="resultIcon"></div>
      <div class="result-title" id="resultTitle"></div>
      <div class="result-description" id="resultDescription"></div><button class="result-action-button" id="resultActionButton" onclick="closeResultModal()"> Continue </button>
     </div>
    </div><!-- Team Selector Modal -->
    <div class="team-selector-modal" id="teamSelectorModal">
     <div class="team-selector-content">
      <div class="team-selector-title" id="selectorTitle">
       Select a Team
      </div>
      <div class="team-select-list" id="teamSelectList"></div>
     </div>
    </div><!-- Scoreboard Screen -->
    <div class="scoreboard-screen" id="scoreboardScreen">
     <h2 class="scoreboard-title">üèÜ Final Results</h2>
     <div class="winner-message" id="winnerMessage"></div><!-- Awards Section -->
     <div class="awards-section" id="awardsSection"></div>
     <div class="scores-list" id="scoresList"></div><button class="restart-game-button" onclick="restartGame()"> üîÑ Play Again </button>
    </div>
   </div>
  </main>
  <div class="fireworks" id="fireworks"></div>
  <script>
    const defaultConfig = {
      game_title: "üéÆ Career Path Quiz Game Pro",
      instruction_text: "6 Teams ‚Ä¢ 6 Careers ‚Ä¢ 5 Questions + Bonus",
      winner_message: "üéâ Congratulations! You are the Winner! üéâ",
      discussion_time: "30",
      background_color: "#667eea",
      surface_color: "#ffffff",
      text_color: "#2d3748",
      primary_action_color: "#667eea",
      secondary_action_color: "#48bb78",
      font_family: "Nunito",
      font_size: 16
    };

    const careerThemes = {
      1: "doctor",
      2: "programmer",
      3: "content-creator",
      4: "salesperson",
      5: "manager",
      6: "businessperson"
    };

    const careers = [
      {
        id: 1,
        name: "Doctor",
        icon: "üë®‚Äç‚öïÔ∏è",
        description: "Healthcare Hero",
        questions: [
          {
            question: "If a patient complains of persistent headaches and dizziness, what should a doctor do first?",
            answers: ["Prescribe pain medication immediately", "Conduct a thorough examination and medical history", "Send them home to rest", "Recommend surgery right away"],
            correct: 1
          },
          {
            question: "What does 'diagnosis' mean in medical practice?",
            answers: ["Treating a disease", "Identifying an illness through examination", "Preventing future health problems", "Performing surgery on patients"],
            correct: 1
          },
          {
            question: "Why is continuing education important for doctors throughout their careers?",
            answers: ["To meet social expectations", "Medical knowledge and treatments constantly evolve", "It's required by hospital administrators", "To earn more money quickly"],
            correct: 1
          },
          {
            question: "What ethical principle requires doctors to maintain patient confidentiality?",
            answers: ["Medical privacy and trust", "Hospital regulations only", "Insurance requirements", "Legal punishment avoidance"],
            correct: 0
          },
          {
            question: "When should a doctor refer a patient to a specialist?",
            answers: ["Only when the patient requests it", "When the condition requires specialized expertise", "Never, doctors can treat everything", "Only in emergency situations"],
            correct: 1
          },
          {
            question: "BONUS: Which of these qualities is MOST essential for a successful medical career?",
            answers: ["Perfect memory for all medical facts", "Compassion combined with clinical expertise", "Ability to work without sleep", "Never showing emotion to patients"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 2,
        name: "Programmer",
        icon: "üë®‚Äçüíª",
        description: "Code Creator",
        questions: [
          {
            question: "What is the purpose of 'debugging' in software development?",
            answers: ["Creating new features quickly", "Identifying and fixing errors in code", "Making programs run slower", "Deleting unnecessary files"],
            correct: 1
          },
          {
            question: "Why is version control (like Git) essential for programmers?",
            answers: ["It makes code look professional", "It tracks changes and enables collaboration", "It's required by all companies", "It automatically fixes bugs"],
            correct: 1
          },
          {
            question: "What does 'scalability' mean in software design?",
            answers: ["Making the interface larger", "The ability to handle growing amounts of work", "Reducing program size", "Increasing profit margins"],
            correct: 1
          },
          {
            question: "When should a programmer refactor their code?",
            answers: ["Never, if it works don't change it", "When code becomes difficult to maintain or understand", "Only at the end of a project", "Every single day without exception"],
            correct: 1
          },
          {
            question: "What is the main benefit of using APIs in programming?",
            answers: ["They make programs more colorful", "They allow different software systems to communicate", "They automatically write code for you", "They eliminate the need for databases"],
            correct: 1
          },
          {
            question: "BONUS: Which programming principle helps create maintainable code?",
            answers: ["Writing the longest code possible", "DRY (Don't Repeat Yourself)", "Avoiding comments completely", "Using only one variable name"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 3,
        name: "Content Creator",
        icon: "üìπ",
        description: "Digital Storyteller",
        questions: [
          {
            question: "What does 'engagement rate' measure for content creators?",
            answers: ["How many hours they work daily", "How actively audiences interact with content", "The quality of camera equipment", "The number of competitors"],
            correct: 1
          },
          {
            question: "Why is consistency important for building an online audience?",
            answers: ["It helps establish trust and expectations", "It's required by social media platforms", "It guarantees viral content", "It's not actually important"],
            correct: 0
          },
          {
            question: "What should a content creator consider when collaborating with brands?",
            answers: ["Only the payment amount", "Brand alignment with their values and audience", "Taking every opportunity offered", "Ignoring audience feedback completely"],
            correct: 1
          },
          {
            question: "How can analytics tools help content creators improve their work?",
            answers: ["They automatically create content", "They provide insights into audience preferences and behavior", "They guarantee more followers instantly", "They replace the need for creativity"],
            correct: 1
          },
          {
            question: "What does 'content diversification' mean for a creator's strategy?",
            answers: ["Creating only one type of content", "Producing various content formats across platforms", "Copying other creators' ideas", "Posting randomly without planning"],
            correct: 1
          },
          {
            question: "BONUS: What is the biggest challenge for content creators in 2024?",
            answers: ["Finding a camera", "Standing out in a saturated market with authentic content", "Learning to read", "Avoiding the internet"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 4,
        name: "Salesperson",
        icon: "ü§ù",
        description: "Sales Expert",
        questions: [
          {
            question: "What is the purpose of 'building rapport' with potential customers?",
            answers: ["To manipulate them into buying", "To establish trust and positive relationships", "To waste time before selling", "To appear friendly without meaning it"],
            correct: 1
          },
          {
            question: "How should a salesperson handle objections from customers?",
            answers: ["Argue with them until they agree", "Listen carefully and address their concerns", "Give up immediately", "Pressure them into deciding quickly"],
            correct: 1
          },
          {
            question: "What does 'qualifying a lead' mean in sales?",
            answers: ["Giving them a certificate", "Determining if they're a potential customer", "Rejecting unimportant people", "Collecting their contact information"],
            correct: 1
          },
          {
            question: "Why is product knowledge crucial for successful salespeople?",
            answers: ["It helps answer questions and build credibility", "It makes them sound smart", "Customers never ask questions anyway", "It's only needed for technical products"],
            correct: 0
          },
          {
            question: "What is the difference between 'hard selling' and 'consultative selling'?",
            answers: ["One is difficult, one is easy", "Hard selling pushes products; consultative focuses on customer needs", "They are exactly the same approach", "Consultative selling is outdated"],
            correct: 1
          },
          {
            question: "BONUS: What is the most effective closing technique in modern sales?",
            answers: ["Pressuring for immediate decision", "Creating value and letting customers decide when ready", "Using aggressive tactics", "Offering unlimited discounts"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 5,
        name: "Manager",
        icon: "üëî",
        description: "Team Leader",
        questions: [
          {
            question: "What does 'delegation' mean in management?",
            answers: ["Doing all the work yourself", "Assigning tasks to team members appropriately", "Avoiding responsibilities completely", "Eliminating positions in the company"],
            correct: 1
          },
          {
            question: "How should a manager handle underperforming team members?",
            answers: ["Fire them immediately without discussion", "Provide feedback, support, and clear expectations", "Ignore the problem completely", "Publicly criticize them to others"],
            correct: 1
          },
          {
            question: "What is the purpose of setting SMART goals in management?",
            answers: ["To sound intelligent in meetings", "To create Specific, Measurable, Achievable, Relevant, Time-bound objectives", "To make goals impossible to reach", "To confuse team members"],
            correct: 1
          },
          {
            question: "Why is emotional intelligence important for managers?",
            answers: ["It helps them manipulate employees", "It enables understanding and managing team emotions effectively", "It's not relevant to management", "It only matters in personal life"],
            correct: 1
          },
          {
            question: "What should a manager prioritize when making strategic decisions?",
            answers: ["Personal preferences only", "Long-term company goals and team impact", "What's easiest at the moment", "Following every employee suggestion"],
            correct: 1
          },
          {
            question: "BONUS: What leadership style is most effective in modern workplaces?",
            answers: ["Authoritarian control", "Adaptive leadership that adjusts to team and situation", "Completely hands-off approach", "Micromanaging every detail"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 6,
        name: "Businessperson",
        icon: "üíº",
        description: "Entrepreneur",
        questions: [
          {
            question: "What is a 'business model' and why is it important?",
            answers: ["A fashion trend in business", "A plan for how a company creates and delivers value", "A type of contract", "A building design for offices"],
            correct: 1
          },
          {
            question: "What does 'market research' help businesspeople understand?",
            answers: ["Only competitor prices", "Customer needs, trends, and market opportunities", "How to copy other businesses", "Stock market predictions only"],
            correct: 1
          },
          {
            question: "Why do many startups fail in their first few years?",
            answers: ["Bad luck only", "Poor planning, cash flow issues, or lack of market need", "Too much success too quickly", "Government regulations exclusively"],
            correct: 1
          },
          {
            question: "What does 'networking' mean in a business context?",
            answers: ["Installing computer systems", "Building professional relationships for mutual benefit", "Social media posting only", "Avoiding competition completely"],
            correct: 1
          },
          {
            question: "How should entrepreneurs respond to business failures?",
            answers: ["Give up immediately and never try again", "Learn from mistakes and adapt their approach", "Blame others for the problems", "Ignore what went wrong"],
            correct: 1
          },
          {
            question: "BONUS: What is the key to sustainable business growth?",
            answers: ["Rapid expansion at any cost", "Balancing growth with financial stability and customer satisfaction", "Copying successful competitors exactly", "Avoiding all risks completely"],
            correct: 1,
            isBonus: true
          }
        ]
      }
    ];

    // Career Future Questions for Lucky Boxes
    const careerFutureQuestions = [
      {
        question: "What is the MOST important factor when choosing a career path?",
        answers: ["Only the salary and benefits", "Alignment with your interests, values, and long-term goals", "What your parents want you to do", "Choosing the easiest option available"],
        correct: 1
      },
      {
        question: "Why is lifelong learning essential for career success?",
        answers: ["It's not really necessary", "Industries and technologies constantly evolve and change", "It's only for people who failed initially", "Employers don't value continuous education"],
        correct: 1
      },
      {
        question: "What should you do if you realize your chosen career isn't right for you?",
        answers: ["Stick with it no matter what because you've invested time", "Assess your options and consider pivoting to a better fit", "Give up on having a career entirely", "Blame others for the poor choice"],
        correct: 1
      },
      {
        question: "How can networking benefit your career development?",
        answers: ["It's a waste of time and energy", "It opens doors to opportunities, mentorship, and industry insights", "It only works for extroverted people", "It's just about collecting business cards"],
        correct: 1
      },
      {
        question: "What role does work-life balance play in long-term career satisfaction?",
        answers: ["It doesn't matter, only work matters", "It's essential for mental health, productivity, and overall happiness", "It's a luxury only for senior positions", "It means you're not ambitious enough"],
        correct: 1
      },
      {
        question: "Why is developing soft skills (communication, teamwork) important for any career?",
        answers: ["They're not important, only technical skills matter", "They enable effective collaboration and career advancement", "They're only needed in customer service roles", "They can't be learned or improved"],
        correct: 1
      },
      {
        question: "What's the best approach when facing setbacks in your career?",
        answers: ["Give up immediately", "Learn from the experience and adapt your strategy", "Blame external factors exclusively", "Never try anything challenging again"],
        correct: 1
      },
      {
        question: "How important is passion in choosing a career?",
        answers: ["Passion doesn't matter at all", "Passion combined with practical considerations creates fulfillment", "Only follow passion, ignore all practical concerns", "Passion will solve all career problems automatically"],
        correct: 1
      },
      {
        question: "What is the value of gaining diverse work experiences early in your career?",
        answers: ["It makes you look unfocused", "It helps you discover strengths and find the right career fit", "You should only have one job ever", "Employers don't value varied experience"],
        correct: 1
      },
      {
        question: "Why should you set career goals for yourself?",
        answers: ["Goals limit your opportunities", "They provide direction, motivation, and measurable progress", "Only companies should set goals for you", "Goals create unnecessary pressure"],
        correct: 1
      }
    ];

    // Lucky Boxes - Random events for Battle Royale
    const luckyBoxes = [
      {
        id: 1,
        icon: "üí∞",
        title: "Jackpot!",
        description: "Your team gets +50 points!",
        type: "add_points",
        points: 50
      },
      {
        id: 2,
        icon: "üíé",
        title: "Mega Bonus",
        description: "Your team gets +30 points!",
        type: "add_points",
        points: 30
      },
      {
        id: 3,
        icon: "‚ö°",
        title: "Power Up",
        description: "Your team gets +20 points!",
        type: "add_points",
        points: 20
      },
      {
        id: 4,
        icon: "üíÄ",
        title: "Penalty!",
        description: "Your team loses -30 points!",
        type: "subtract_points",
        points: 30
      },
      {
        id: 5,
        icon: "üò±",
        title: "Bad Luck",
        description: "Your team loses -20 points!",
        type: "subtract_points",
        points: 20
      },
      {
        id: 6,
        icon: "üîÑ",
        title: "Swap Scores",
        description: "Exchange points with another team!",
        type: "swap_points"
      },
      {
        id: 7,
        icon: "üéØ",
        title: "Steal Points",
        description: "Steal 25 points from any team!",
        type: "steal_points",
        points: 25
      },
      {
        id: 8,
        icon: "üéÅ",
        title: "Gift Points",
        description: "Give 15 points to another team (you also get +15)!",
        type: "gift_points",
        points: 15
      },
      {
        id: 9,
        icon: "üåü",
        title: "Double or Nothing",
        description: "50% chance: Double your score OR lose half!",
        type: "double_or_nothing"
      },
      {
        id: 10,
        icon: "üé≤",
        title: "Lucky Dice",
        description: "Roll the dice: +10, +20, +30, +40, or +50 points!",
        type: "random_points"
      }
    ];

    let teams = [];
    let currentTeamIndex = 0;
    let currentQuestionIndex = 0;
    let selectedAnswer = null;
    let teamScores = {};
    let powerups = {};
    let doublePointsActive = false;
    let answerTimerInterval = null;
    let fastestAnswerTeam = null;
    let fastestAnswerTime = Infinity;
    let questionStartTime = 0;
    let noMistakeTeams = [];
    let timeIsUp = false;
    let currentTeamName = '';
    let isBattleRoyaleMode = false;
    let battleRoyaleAnswers = {};
    let luckyBoxesOpened = [];
    let availableLuckyBoxes = [];
    let currentLuckyTeamIndex = 0;
    let pendingLuckyBoxAction = null;
    let currentLuckyBox = null;
    let currentCareerQuestion = null;
    let luckyQuizSelectedAnswer = null;

    function initializeGame() {
      teams = [];
      currentTeamIndex = 0;
      currentQuestionIndex = 0;
      selectedAnswer = null;
      teamScores = {};
      powerups = {};
      doublePointsActive = false;
      fastestAnswerTeam = null;
      fastestAnswerTime = Infinity;
      noMistakeTeams = [];
      currentTeamName = '';
      isBattleRoyaleMode = false;
      battleRoyaleAnswers = {};
      luckyBoxesOpened = [];
      availableLuckyBoxes = [];
      currentLuckyTeamIndex = 0;
      pendingLuckyBoxAction = null;
      currentLuckyBox = null;
      currentCareerQuestion = null;
      luckyQuizSelectedAnswer = null;
      showScreen('homeScreen');
    }

    function goToTeamSetup() {
      currentTeamIndex = 0;
      currentTeamName = '';
      document.getElementById('teamNameInput').value = '';
      updateTeamCounter();
      renderCareersGrid();
      showScreen('teamSelection');
      document.getElementById('confirmButton').disabled = true;
      showHostMessage('Ch√†o m·ª´ng! H√£y ch·ªçn ngh·ªÅ nghi·ªáp!');
    }

    function validateTeamName() {
      const input = document.getElementById('teamNameInput');
      currentTeamName = input.value.trim();
      
      const hasName = currentTeamName.length > 0;
      const hasCareer = selectedAnswer !== null;
      document.getElementById('confirmButton').disabled = !(hasName && hasCareer);
    }

    function updateTeamCounter() {
      document.getElementById('teamCounter').textContent = `Team ${currentTeamIndex + 1} of 6`;
    }

    function renderCareersGrid() {
      const grid = document.getElementById('careersGrid');
      grid.innerHTML = '';

      careers.forEach(career => {
        const isTaken = teams.some(t => t.careerId === career.id);
        const card = document.createElement('div');
        card.className = `career-card ${isTaken ? 'taken' : ''}`;
        card.setAttribute('data-theme', careerThemes[career.id]);
        card.innerHTML = `
          <span class="career-icon">${career.icon}</span>
          <div class="career-name">${career.name}</div>
          <div class="career-desc">${career.description}</div>
        `;
        
        if (!isTaken) {
          card.onclick = () => selectCareer(career.id, card);
        }
        
        grid.appendChild(card);
      });
    }

    function selectCareer(careerId, cardElement) {
      document.querySelectorAll('.career-card').forEach(c => c.classList.remove('selected'));
      cardElement.classList.add('selected');
      selectedAnswer = careerId;
      
      const hasName = currentTeamName.length > 0;
      const hasCareer = selectedAnswer !== null;
      document.getElementById('confirmButton').disabled = !(hasName && hasCareer);
    }

    function confirmSelection() {
      if (selectedAnswer === null || currentTeamName.length === 0) return;

      const career = careers.find(c => c.id === selectedAnswer);
      
      teams.push({
        name: currentTeamName,
        careerId: career.id,
        careerName: career.name,
        careerIcon: career.icon,
        score: 0,
        mistakes: 0
      });

      teamScores[currentTeamName] = 0;
      powerups[currentTeamName] = {
        fiftyFifty: true,
        doublePoints: true
      };

      if (teams.length < 6) {
        currentTeamIndex++;
        selectedAnswer = null;
        currentTeamName = '';
        document.getElementById('teamNameInput').value = '';
        updateTeamCounter();
        renderCareersGrid();
        document.getElementById('confirmButton').disabled = true;
        document.getElementById('teamNameInput').focus();
        showNotification(`‚úÖ Team registered successfully!`);
      } else {
        showNotification(`‚úÖ All teams ready! Starting quiz...`);
        startQuiz();
      }
    }

    function startQuiz() {
      currentTeamIndex = 0;
      currentQuestionIndex = 0;
      loadQuestion();
      showScreen('quizScreen');
    }

    function loadQuestion() {
      const team = teams[currentTeamIndex];
      const career = careers.find(c => c.id === team.careerId);
      const question = career.questions[currentQuestionIndex];

      document.getElementById('quizTeamName').textContent = team.name;
      document.getElementById('quizCareerName').textContent = `${team.careerIcon} ${team.careerName}`;
      
      const characterDisplay = document.getElementById('characterDisplay');
      const careerCharacter = document.getElementById('careerCharacter');
      careerCharacter.textContent = team.careerIcon;
      characterDisplay.className = 'character-display';
      
      showHostMessage(getHostMessage('question_start'));
      
      const questionNum = currentQuestionIndex + 1;
      const totalQuestions = career.questions.length;
      document.getElementById('questionCounter').textContent = `Question ${questionNum} of ${totalQuestions}`;

      const questionTextEl = document.getElementById('questionText');
      questionTextEl.innerHTML = question.question;
      
      if (question.isBonus) {
        questionTextEl.innerHTML += ' <span class="bonus-indicator">‚≠ê BONUS +25pts</span>';
      }

      const answersGrid = document.getElementById('answersGrid');
      answersGrid.innerHTML = '';

      question.answers.forEach((answer, index) => {
        const button = document.createElement('button');
        button.className = 'answer-button';
        button.textContent = answer;
        button.onclick = () => selectAnswerOption(index, button);
        answersGrid.appendChild(button);
      });

      const teamPowerups = powerups[team.name];
      document.getElementById('fiftyFiftyBtn').disabled = !teamPowerups.fiftyFifty;
      document.getElementById('doublePointsBtn').disabled = !teamPowerups.doublePoints;

      if (!teamPowerups.fiftyFifty) document.getElementById('fiftyFiftyBtn').classList.add('used');
      if (!teamPowerups.doublePoints) document.getElementById('doublePointsBtn').classList.add('used');

      updateLiveLeaderboard();
      
      selectedAnswer = null;
      timeIsUp = false;
      document.getElementById('submitButton').disabled = true;
      questionStartTime = Date.now();
      
      startAnswerTimer();
    }

    function startAnswerTimer() {
      const answerTime = parseInt(window.elementSdk?.config?.discussion_time || defaultConfig.discussion_time);
      let timeLeft = answerTime;
      
      const timerEl = document.getElementById('answerTimer');
      const secondsEl = document.getElementById('timerSeconds');
      const characterDisplay = document.getElementById('characterDisplay');
      
      timerEl.classList.remove('warning', 'danger');
      timerEl.classList.add('active');
      secondsEl.textContent = timeLeft;

      if (answerTimerInterval) {
        clearInterval(answerTimerInterval);
      }

      answerTimerInterval = setInterval(() => {
        timeLeft--;
        secondsEl.textContent = timeLeft;
        
        if (timeLeft <= 10 && timeLeft > 5) {
          timerEl.classList.add('warning');
          timerEl.classList.remove('danger');
          showHostMessage('‚è∞ C√≤n 10 gi√¢y!');
        } else if (timeLeft <= 5) {
          timerEl.classList.add('danger');
          timerEl.classList.remove('warning');
          
          characterDisplay.classList.add('sweating');
          
          if (timeLeft === 5) {
            for (let i = 0; i < 3; i++) {
              const sweat = document.createElement('div');
              sweat.className = 'sweat-drop';
              sweat.textContent = 'üíß';
              characterDisplay.appendChild(sweat);
            }
          }
          
          if (timeLeft === 3) {
            showHostMessage('üò∞ Nhanh l√™n!');
          }
        }
        
        if (timeLeft <= 0) {
          clearInterval(answerTimerInterval);
          timeIsUp = true;
          characterDisplay.classList.remove('sweating');
          handleTimeUp();
        }
      }, 1000);
    }

    function handleTimeUp() {
      if (isBattleRoyaleMode) {
        showNotification('‚è∞ Time is up for Battle Royale! Revealing answers...');
        processAllBattleRoyaleAnswers();
        return;
      }

      showNotification('‚è∞ Time is up! No points awarded.');
      
      const team = teams[currentTeamIndex];
      const career = careers.find(c => c.id === team.careerId);
      const question = career.questions[currentQuestionIndex];
      const buttons = document.querySelectorAll('.answer-button');
      
      buttons[question.correct].classList.add('correct');
      
      buttons.forEach(btn => btn.disabled = true);
      document.getElementById('submitButton').disabled = true;
      
      team.mistakes++;

      setTimeout(() => {
        if (currentQuestionIndex < career.questions.length - 1) {
          currentQuestionIndex++;
          loadQuestion();
        } else {
          if (team.mistakes === 0) {
            noMistakeTeams.push(team.name);
          }

          if (currentTeamIndex < teams.length - 1) {
            currentTeamIndex++;
            currentQuestionIndex = 0;
            loadQuestion();
          } else {
            startBattleRoyale();
          }
        }
      }, 2500);
    }

    function selectAnswerOption(index, buttonElement) {
      document.querySelectorAll('.answer-button').forEach(btn => {
        btn.classList.remove('selected');
      });
      buttonElement.classList.add('selected');
      selectedAnswer = index;
      document.getElementById('submitButton').disabled = false;
    }

    function useFiftyFifty() {
      const team = teams[currentTeamIndex];
      if (!powerups[team.name].fiftyFifty) return;

      const career = careers.find(c => c.id === team.careerId);
      const question = career.questions[currentQuestionIndex];
      const buttons = document.querySelectorAll('.answer-button');
      
      let eliminated = 0;
      buttons.forEach((btn, index) => {
        if (index !== question.correct && eliminated < 2) {
          btn.classList.add('eliminated');
          eliminated++;
        }
      });

      powerups[team.name].fiftyFifty = false;
      document.getElementById('fiftyFiftyBtn').disabled = true;
      document.getElementById('fiftyFiftyBtn').classList.add('used');
      
      showNotification('‚ö° 50/50 activated! 2 wrong answers eliminated');
    }

    function useDoublePoints() {
      const team = teams[currentTeamIndex];
      if (!powerups[team.name].doublePoints) return;

      doublePointsActive = true;
      powerups[team.name].doublePoints = false;
      document.getElementById('doublePointsBtn').disabled = true;
      document.getElementById('doublePointsBtn').classList.add('used');
      
      showNotification('üíé Double Points activated! This question is worth 2x points!');
    }

    function submitAnswer() {
      if (selectedAnswer === null || timeIsUp) return;

      if (answerTimerInterval) {
        clearInterval(answerTimerInterval);
      }

      const team = teams[currentTeamIndex];
      const career = careers.find(c => c.id === team.careerId);
      const question = career.questions[currentQuestionIndex];
      const buttons = document.querySelectorAll('.answer-button');
      const characterDisplay = document.getElementById('characterDisplay');

      characterDisplay.classList.remove('sweating');
      const sweatDrops = characterDisplay.querySelectorAll('.sweat-drop');
      sweatDrops.forEach(drop => drop.remove());

      const answerTime = Date.now() - questionStartTime;

      let pointsEarned = 0;

      if (selectedAnswer === question.correct) {
        buttons[selectedAnswer].classList.add('correct');
        
        characterDisplay.classList.add('correct');
        createEmotionParticles('happy');
        showHostMessage(getHostMessage('correct'));
        
        pointsEarned = question.isBonus ? 25 : 15;
        if (doublePointsActive) {
          pointsEarned *= 2;
          showNotification(`üî• Correct! +${pointsEarned} points (Double Points!)`);
        } else {
          showNotification(`‚úÖ Correct! +${pointsEarned} points`);
        }
        
        team.score += pointsEarned;
        teamScores[team.name] += pointsEarned;

        if (answerTime < fastestAnswerTime) {
          fastestAnswerTime = answerTime;
          fastestAnswerTeam = team.name;
        }
      } else {
        buttons[selectedAnswer].classList.add('wrong');
        buttons[question.correct].classList.add('correct');
        
        characterDisplay.classList.add('wrong');
        createEmotionParticles('sad');
        showHostMessage(getHostMessage('wrong'));
        
        team.mistakes++;
        showNotification('‚ùå Wrong answer!');
      }

      doublePointsActive = false;
      document.getElementById('submitButton').disabled = true;
      buttons.forEach(btn => btn.disabled = true);

      setTimeout(() => {
        if (currentQuestionIndex < career.questions.length - 1) {
          currentQuestionIndex++;
          loadQuestion();
        } else {
          if (team.mistakes === 0) {
            noMistakeTeams.push(team.name);
          }

          if (currentTeamIndex < teams.length - 1) {
            currentTeamIndex++;
            currentQuestionIndex = 0;
            loadQuestion();
          } else {
            startBattleRoyale();
          }
        }
      }, 2500);
    }

    function updateLiveLeaderboard() {
      const list = document.getElementById('leaderboardList');
      list.innerHTML = '';

      const sortedTeams = [...teams].sort((a, b) => b.score - a.score);
      const currentTeam = teams[currentTeamIndex];

      sortedTeams.forEach((team, index) => {
        const item = document.createElement('div');
        item.className = `leaderboard-item ${team.name === currentTeam.name ? 'current' : ''}`;
        item.innerHTML = `
          <div class="leaderboard-team">
            <span class="leaderboard-rank">${index + 1}</span>
            <span>${team.careerIcon} ${team.name}</span>
          </div>
          <div class="leaderboard-score">${team.score}</div>
        `;
        list.appendChild(item);
      });
    }

    function showScoreboard() {
      const sortedTeams = [...teams].sort((a, b) => b.score - a.score);
      const winner = sortedTeams[0];

      document.getElementById('winnerMessage').textContent = 
        `üéâ ${winner.name} (${winner.careerIcon} ${winner.careerName}) - Best Future Planner Award! üéâ`;

      const awardsSection = document.getElementById('awardsSection');
      awardsSection.innerHTML = '';

      if (fastestAnswerTeam) {
        const fastAward = document.createElement('div');
        fastAward.className = 'award-badge';
        fastAward.innerHTML = `
          <div class="award-icon">‚ö°</div>
          <div class="award-title">Fastest Answer</div>
          <div class="award-winner">${fastestAnswerTeam}</div>
        `;
        awardsSection.appendChild(fastAward);
      }

      if (noMistakeTeams.length > 0) {
        noMistakeTeams.forEach(teamName => {
          const perfectAward = document.createElement('div');
          perfectAward.className = 'award-badge';
          perfectAward.innerHTML = `
            <div class="award-icon">üíØ</div>
            <div class="award-title">Perfect Score</div>
            <div class="award-winner">${teamName}</div>
          `;
          awardsSection.appendChild(perfectAward);
        });
      }

      const scoresList = document.getElementById('scoresList');
      scoresList.innerHTML = '';

      sortedTeams.forEach((team, index) => {
        const item = document.createElement('div');
        item.className = `score-item rank-${index + 1}`;
        item.style.animationDelay = `${index * 0.1}s`;
        item.innerHTML = `
          <div class="score-left">
            <div class="rank-badge">${index === 0 ? 'üèÜ' : index + 1}</div>
            <div class="team-details">
              <div class="team-name-score">${team.name}</div>
              <div class="career-name-score">${team.careerIcon} ${team.careerName}</div>
            </div>
          </div>
          <div class="score-points">${team.score}</div>
        `;
        scoresList.appendChild(item);
      });

      showScreen('scoreboardScreen');
      createFireworks();
    }

    function createFireworks() {
      const container = document.getElementById('fireworks');
      container.innerHTML = '';

      const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1', '#f093fb', '#4facfe'];

      for (let i = 0; i < 60; i++) {
        setTimeout(() => {
          const x = Math.random() * window.innerWidth;
          const y = Math.random() * window.innerHeight * 0.6;

          for (let j = 0; j < 12; j++) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            firework.style.background = colors[Math.floor(Math.random() * colors.length)];

            const angle = (j / 12) * Math.PI * 2;
            const velocity = 50 + Math.random() * 100;
            firework.style.setProperty('--tx', Math.cos(angle) * velocity + 'px');
            firework.style.setProperty('--ty', Math.sin(angle) * velocity + 'px');

            container.appendChild(firework);

            setTimeout(() => firework.remove(), 1500);
          }
        }, i * 150);
      }
    }

    function startBattleRoyale() {
      isBattleRoyaleMode = true;
      luckyBoxesOpened = [];
      availableLuckyBoxes = [...luckyBoxes];
      currentLuckyTeamIndex = 0;
      
      showNotification('üé∞ LUCKY BOXES TIME! Answer questions to open boxes!');
      
      setTimeout(() => {
        startLuckyBoxRound();
      }, 3000);
    }

    function startLuckyBoxRound() {
      if (currentLuckyTeamIndex >= teams.length) {
        showScoreboard();
        return;
      }

      const team = teams[currentLuckyTeamIndex];
      document.getElementById('luckyTeamName').textContent = `üé∞ ${team.careerIcon} ${team.name}'s Turn`;
      
      showHostMessage(getHostMessage('lucky_start'));
      
      updateLuckyLeaderboard();
      renderLuckyBoxes();
      showScreen('luckyBoxesScreen');
    }

    function renderLuckyBoxes() {
      const grid = document.getElementById('boxesGrid');
      grid.innerHTML = '';

      availableLuckyBoxes.forEach((box, index) => {
        const isOpened = luckyBoxesOpened.includes(box.id);
        const boxElement = document.createElement('div');
        boxElement.className = `lucky-box ${isOpened ? 'opened' : ''}`;
        boxElement.innerHTML = `
          <div class="box-icon">üéÅ</div>
          <div class="box-number">Box ${box.id}</div>
        `;
        
        if (!isOpened) {
          boxElement.onclick = () => showLuckyQuiz(box);
        }
        
        grid.appendChild(boxElement);
      });
    }

    function showLuckyQuiz(box) {
      currentLuckyBox = box;
      luckyQuizSelectedAnswer = null;
      
      const randomQuestion = careerFutureQuestions[Math.floor(Math.random() * careerFutureQuestions.length)];
      currentCareerQuestion = randomQuestion;
      
      document.getElementById('quizModalQuestion').textContent = randomQuestion.question;
      
      const answersContainer = document.getElementById('quizModalAnswers');
      answersContainer.innerHTML = '';
      
      randomQuestion.answers.forEach((answer, index) => {
        const button = document.createElement('button');
        button.className = 'quiz-answer-button';
        button.textContent = answer;
        button.onclick = () => selectLuckyQuizAnswer(index, button);
        answersContainer.appendChild(button);
      });
      
      document.getElementById('quizSubmitButton').disabled = true;
      document.getElementById('luckyQuizModal').classList.add('show');
    }

    function selectLuckyQuizAnswer(index, buttonElement) {
      document.querySelectorAll('.quiz-answer-button').forEach(btn => {
        btn.classList.remove('selected');
      });
      buttonElement.classList.add('selected');
      luckyQuizSelectedAnswer = index;
      document.getElementById('quizSubmitButton').disabled = false;
    }

    function submitLuckyQuizAnswer() {
      if (luckyQuizSelectedAnswer === null) return;
      
      const buttons = document.querySelectorAll('.quiz-answer-button');
      const isCorrect = luckyQuizSelectedAnswer === currentCareerQuestion.correct;
      
      if (isCorrect) {
        buttons[luckyQuizSelectedAnswer].classList.add('correct');
        showNotification('‚úÖ Correct! Opening your lucky box...');
        
        setTimeout(() => {
          document.getElementById('luckyQuizModal').classList.remove('show');
          openLuckyBox(currentLuckyBox);
        }, 1500);
      } else {
        buttons[luckyQuizSelectedAnswer].classList.add('wrong');
        buttons[currentCareerQuestion.correct].classList.add('correct');
        showNotification('‚ùå Wrong answer! Try again next time...');
        
        setTimeout(() => {
          document.getElementById('luckyQuizModal').classList.remove('show');
          currentLuckyTeamIndex++;
          startLuckyBoxRound();
        }, 2000);
      }
      
      document.getElementById('quizSubmitButton').disabled = true;
      buttons.forEach(btn => btn.disabled = true);
    }

    function openLuckyBox(box) {
      luckyBoxesOpened.push(box.id);
      
      const currentTeam = teams[currentLuckyTeamIndex];
      
      document.getElementById('resultIcon').textContent = box.icon;
      document.getElementById('resultTitle').textContent = box.title;
      document.getElementById('resultDescription').textContent = box.description;
      
      processLuckyBoxEffect(box, currentTeam);
      
      document.getElementById('luckyResultModal').classList.add('show');
    }

    function processLuckyBoxEffect(box, team) {
      pendingLuckyBoxAction = { box, team };
      
      switch(box.type) {
        case 'add_points':
          team.score += box.points;
          teamScores[team.name] += box.points;
          showNotification(`${team.name} gained +${box.points} points!`);
          break;
          
        case 'subtract_points':
          team.score = Math.max(0, team.score - box.points);
          teamScores[team.name] = Math.max(0, teamScores[team.name] - box.points);
          showNotification(`${team.name} lost -${box.points} points!`);
          break;
          
        case 'swap_points':
          break;
          
        case 'steal_points':
          break;
          
        case 'gift_points':
          team.score += box.points;
          teamScores[team.name] += box.points;
          break;
          
        case 'double_or_nothing':
          const chance = Math.random();
          if (chance < 0.5) {
            const originalScore = team.score;
            team.score *= 2;
            teamScores[team.name] *= 2;
            document.getElementById('resultDescription').textContent = 
              `üéâ SUCCESS! Your score doubled from ${originalScore} to ${team.score}!`;
            showNotification(`${team.name} DOUBLED their score!`);
          } else {
            const originalScore = team.score;
            team.score = Math.floor(team.score / 2);
            teamScores[team.name] = Math.floor(teamScores[team.name] / 2);
            document.getElementById('resultDescription').textContent = 
              `üíî UNLUCKY! Your score reduced from ${originalScore} to ${team.score}!`;
            showNotification(`${team.name} lost half their score!`);
          }
          break;
          
        case 'random_points':
          const randomPoints = [10, 20, 30, 40, 50][Math.floor(Math.random() * 5)];
          team.score += randomPoints;
          teamScores[team.name] += randomPoints;
          document.getElementById('resultDescription').textContent = 
            `üé≤ You rolled ${randomPoints} points!`;
          showNotification(`${team.name} rolled +${randomPoints} points!`);
          break;
      }
      
      updateLuckyLeaderboard();
    }

    function closeResultModal() {
      const action = pendingLuckyBoxAction;
      
      if (action && (action.box.type === 'swap_points' || action.box.type === 'steal_points' || action.box.type === 'gift_points')) {
        showTeamSelector(action.box.type);
      } else {
        document.getElementById('luckyResultModal').classList.remove('show');
        currentLuckyTeamIndex++;
        startLuckyBoxRound();
      }
    }

    function showTeamSelector(actionType) {
      document.getElementById('luckyResultModal').classList.remove('show');
      
      const currentTeam = teams[currentLuckyTeamIndex];
      const otherTeams = teams.filter(t => t.name !== currentTeam.name);
      
      let title = 'Select a Team';
      if (actionType === 'swap_points') title = 'üîÑ Swap Scores With:';
      if (actionType === 'steal_points') title = 'üéØ Steal Points From:';
      if (actionType === 'gift_points') title = 'üéÅ Give Points To:';
      
      document.getElementById('selectorTitle').textContent = title;
      
      const listEl = document.getElementById('teamSelectList');
      listEl.innerHTML = '';
      
      otherTeams.forEach(team => {
        const button = document.createElement('button');
        button.className = 'team-select-button';
        button.innerHTML = `
          <span>${team.careerIcon} ${team.name}</span>
          <span>${team.score} pts</span>
        `;
        button.onclick = () => selectTeamForAction(team, actionType);
        listEl.appendChild(button);
      });
      
      document.getElementById('teamSelectorModal').classList.add('show');
    }

    function selectTeamForAction(targetTeam, actionType) {
      const currentTeam = teams[currentLuckyTeamIndex];
      const action = pendingLuckyBoxAction;
      
      if (actionType === 'swap_points') {
        const tempScore = currentTeam.score;
        currentTeam.score = targetTeam.score;
        targetTeam.score = tempScore;
        
        teamScores[currentTeam.name] = currentTeam.score;
        teamScores[targetTeam.name] = targetTeam.score;
        
        showNotification(`${currentTeam.name} and ${targetTeam.name} swapped scores!`);
      } else if (actionType === 'steal_points') {
        const stolenPoints = Math.min(action.box.points, targetTeam.score);
        targetTeam.score -= stolenPoints;
        currentTeam.score += stolenPoints;
        
        teamScores[currentTeam.name] += stolenPoints;
        teamScores[targetTeam.name] -= stolenPoints;
        
        showNotification(`${currentTeam.name} stole ${stolenPoints} points from ${targetTeam.name}!`);
      } else if (actionType === 'gift_points') {
        targetTeam.score += action.box.points;
        teamScores[targetTeam.name] += action.box.points;
        
        showNotification(`${currentTeam.name} gifted ${action.box.points} points to ${targetTeam.name}!`);
      }
      
      document.getElementById('teamSelectorModal').classList.remove('show');
      updateLuckyLeaderboard();
      
      currentLuckyTeamIndex++;
      startLuckyBoxRound();
    }

    function updateLuckyLeaderboard() {
      const list = document.getElementById('luckyLeaderboardList');
      list.innerHTML = '';

      const sortedTeams = [...teams].sort((a, b) => b.score - a.score);
      const currentTeam = teams[currentLuckyTeamIndex];

      sortedTeams.forEach((team, index) => {
        const item = document.createElement('div');
        item.className = `leaderboard-item ${currentTeam && team.name === currentTeam.name ? 'current' : ''}`;
        item.innerHTML = `
          <div class="leaderboard-team">
            <span class="leaderboard-rank">${index + 1}</span>
            <span>${team.careerIcon} ${team.name}</span>
          </div>
          <div class="leaderboard-score">${team.score}</div>
        `;
        list.appendChild(item);
      });
    }

    function showNotification(message) {
      const toast = document.getElementById('notificationToast');
      toast.textContent = message;
      toast.classList.add('show');

      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    function showHostMessage(message) {
      const hostSpeech = document.getElementById('hostSpeech');
      hostSpeech.textContent = message;
      hostSpeech.classList.add('show');

      setTimeout(() => {
        hostSpeech.classList.remove('show');
      }, 3000);
    }

    function getHostMessage(type) {
      const messages = {
        question_start: ['C√¢u h·ªèi m·ªõi ƒë√¢y!', 'S·∫µn s√†ng ch∆∞a?', 'Ch√∫c may m·∫Øn!', 'H√£y th·ª≠ s·ª©c nh√©!'],
        correct: ['Tuy·ªát v·ªùi! üéâ', 'Ch√≠nh x√°c! ‚ú®', 'Gi·ªèi qu√°! üí™', 'Xu·∫•t s·∫Øc! üåü'],
        wrong: ['√îi kh√¥ng! üòø', 'Ti·∫øc qu√°!', 'Sai r·ªìi...', 'L·∫ßn sau s·∫Ω ƒë√∫ng!'],
        lucky_start: ['Ch·ªçn h·ªôp may m·∫Øn!', 'V·∫≠n may ƒëang ch·ªù!', 'H·ªôp n√†o nh·ªâ?', 'H√£y ch·ªçn ƒëi!'],
        game_start: ['B·∫Øt ƒë·∫ßu th√¥i! üéÆ', 'Tr√≤ ch∆°i b·∫Øt ƒë·∫ßu!', 'Ch√∫c vui v·∫ª!']
      };

      const messageArray = messages[type] || messages.question_start;
      return messageArray[Math.floor(Math.random() * messageArray.length)];
    }

    function createEmotionParticles(emotion) {
      const characterDisplay = document.getElementById('characterDisplay');
      const emojis = emotion === 'happy' ? ['‚ù§Ô∏è', '‚≠ê', '‚ú®', 'üéâ', 'üíØ'] : ['üíî', 'üò¢', 'üò≠', 'üíß'];
      
      for (let i = 0; i < 8; i++) {
        setTimeout(() => {
          const particle = document.createElement('div');
          particle.className = 'emotion-particle';
          particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
          
          const angle = (i / 8) * Math.PI * 2;
          const distance = 80 + Math.random() * 40;
          particle.style.setProperty('--tx', Math.cos(angle) * distance + 'px');
          particle.style.setProperty('--ty', Math.sin(angle) * distance + 'px');
          
          particle.style.left = '50%';
          particle.style.top = '50%';
          
          characterDisplay.appendChild(particle);
          
          setTimeout(() => particle.remove(), 1000);
        }, i * 50);
      }
    }

    function showScreen(screenName) {
      document.getElementById('homeScreen').classList.add('hidden');
      document.getElementById('teamSelection').classList.add('hidden');
      document.getElementById('quizScreen').classList.remove('active');
      document.getElementById('luckyBoxesScreen').classList.remove('active');
      document.getElementById('scoreboardScreen').classList.remove('active');

      if (screenName === 'homeScreen') {
        document.getElementById('homeScreen').classList.remove('hidden');
      }

      if (screenName === 'teamSelection') {
        document.getElementById('teamSelection').classList.remove('hidden');
      }

      if (screenName === 'quizScreen') {
        document.getElementById('quizScreen').classList.add('active');
      }

      if (screenName === 'luckyBoxesScreen') {
        document.getElementById('luckyBoxesScreen').classList.add('active');
      }

      if (screenName === 'scoreboardScreen') {
        document.getElementById('scoreboardScreen').classList.add('active');
      }
    }

    function restartGame() {
      document.getElementById('fireworks').innerHTML = '';
      initializeGame();
    }

    async function onConfigChange(config) {
      const gameTitle = document.getElementById('gameTitle');
      const instructionText = document.getElementById('instructionText');

      if (gameTitle) {
        gameTitle.textContent = config.game_title || defaultConfig.game_title;
      }

      if (instructionText) {
        instructionText.textContent = config.instruction_text || defaultConfig.instruction_text;
      }

      const backgroundColor = config.background_color || defaultConfig.background_color;
      const surfaceColor = config.surface_color || defaultConfig.surface_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const primaryColor = config.primary_action_color || defaultConfig.primary_action_color;
      const secondaryColor = config.secondary_action_color || defaultConfig.secondary_action_color;

      document.body.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${backgroundColor}dd 100%)`;

      const gameCard = document.querySelector('.game-card');
      if (gameCard) {
        gameCard.style.background = surfaceColor;
      }

      const textElements = document.querySelectorAll('.game-title, .question-text, .team-name-score, .scoreboard-title');
      textElements.forEach(el => {
        el.style.color = textColor;
      });

      const primaryButtons = document.querySelectorAll('.submit-answer-button, .restart-game-button, .current-team-banner, .rank-badge');
      primaryButtons.forEach(btn => {
        btn.style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${primaryColor}dd 100%)`;
      });

      const secondaryButtons = document.querySelectorAll('.confirm-button, .winner-message');
      secondaryButtons.forEach(btn => {
        btn.style.background = `linear-gradient(135deg, ${secondaryColor} 0%, ${secondaryColor}dd 100%)`;
      });

      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontSize = config.font_size || defaultConfig.font_size;
      const baseFontStack = 'Nunito, Segoe UI, sans-serif';

      document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;

      if (gameTitle) {
        gameTitle.style.fontSize = `${baseFontSize * 2.625}px`;
      }

      if (instructionText) {
        instructionText.style.fontSize = `${baseFontSize * 1.125}px`;
      }

      const questionTexts = document.querySelectorAll('.question-text');
      questionTexts.forEach(el => {
        el.style.fontSize = `${baseFontSize * 1.5}px`;
      });

      const answerButtons = document.querySelectorAll('.answer-button');
      answerButtons.forEach(el => {
        el.style.fontSize = `${baseFontSize * 1.0625}px`;
      });
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.surface_color || defaultConfig.surface_color,
              set: (value) => {
                config.surface_color = value;
                window.elementSdk.setConfig({ surface_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.primary_action_color || defaultConfig.primary_action_color,
              set: (value) => {
                config.primary_action_color = value;
                window.elementSdk.setConfig({ primary_action_color: value });
              }
            },
            {
              get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
              set: (value) => {
                config.secondary_action_color = value;
                window.elementSdk.setConfig({ secondary_action_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["game_title", config.game_title || defaultConfig.game_title],
          ["instruction_text", config.instruction_text || defaultConfig.instruction_text],
          ["winner_message", config.winner_message || defaultConfig.winner_message],
          ["discussion_time", config.discussion_time || defaultConfig.discussion_time]
        ])
      });
    }

    initializeGame();
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Career Path Quiz Game Pro</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Poppins', 'Inter', 'Nunito', sans-serif;
      background: linear-gradient(135deg, #ff0080 0%, #7928ca 50%, #0070f3 100%);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      min-height: 100%;
      width: 100%;
      overflow-x: hidden;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    * {
      box-sizing: border-box;
    }

    .background-pattern {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 20% 50%, rgba(255, 0, 255, 0.2) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.2) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(255, 255, 0, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 60% 60%, rgba(0, 255, 128, 0.15) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
      animation: patternPulse 8s ease-in-out infinite;
    }

    @keyframes patternPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    
    .game-container {
      position: relative;
      width: 100%;
      min-height: 100%;
      padding: 30px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 1;
    }
    
    .game-card {
      background: rgba(20, 20, 40, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 32px;
      padding: 40px;
      max-width: 1000px;
      width: 100%;
      box-shadow: 
        0 0 80px rgba(255, 0, 255, 0.3),
        0 0 120px rgba(0, 255, 255, 0.2),
        0 25px 80px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
      animation: slideInUp 0.6s ease-out, cardGlow 3s ease-in-out infinite;
      border: 2px solid rgba(255, 255, 255, 0.1);
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes cardGlow {
      0%, 100% {
        box-shadow: 
          0 0 80px rgba(255, 0, 255, 0.3),
          0 0 120px rgba(0, 255, 255, 0.2),
          0 25px 80px rgba(0, 0, 0, 0.5);
      }
      50% {
        box-shadow: 
          0 0 100px rgba(255, 0, 255, 0.5),
          0 0 140px rgba(0, 255, 255, 0.3),
          0 25px 80px rgba(0, 0, 0, 0.5);
      }
    }

    .game-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: linear-gradient(90deg, #ff0080, #ff00ff, #00ffff, #00ff88, #ffff00, #ff0080);
      background-size: 200% 100%;
      animation: gradientShift 3s linear infinite;
      box-shadow: 0 0 20px rgba(255, 0, 255, 0.8);
    }

    @keyframes gradientShift {
      0% { background-position: 0% 0%; }
      100% { background-position: 200% 0%; }
    }
    
    .game-header {
      text-align: center;
      margin-bottom: 35px;
    }
    
    .game-title {
      font-size: 42px;
      font-weight: 900;
      background: linear-gradient(135deg, #ff00ff 0%, #00ffff 50%, #ffff00 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      background-size: 200% 200%;
      animation: titleGradient 3s ease infinite;
      margin: 0 0 12px 0;
      text-shadow: 
        0 0 30px rgba(255, 0, 255, 0.6),
        0 0 60px rgba(0, 255, 255, 0.4);
      filter: drop-shadow(0 0 10px rgba(255, 0, 255, 0.8));
    }

    @keyframes titleGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    .game-subtitle {
      font-size: 18px;
      color: #a0aec0;
      margin: 0;
      font-weight: 600;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    }

    /* Team Selection Screen */
    .team-selection {
      display: block;
    }

    .team-selection.hidden {
      display: none;
    }

    .selection-instruction {
      text-align: center;
      font-size: 20px;
      color: #2d3748;
      margin-bottom: 30px;
      font-weight: 600;
    }

    .careers-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .career-card {
      background: rgba(30, 30, 60, 0.8);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 0, 255, 0.3);
      border-radius: 20px;
      padding: 25px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
    }

    .career-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 0, 255, 0.3), transparent);
      transition: left 0.5s ease;
    }

    .career-card:hover::before {
      left: 100%;
    }

    .career-card:hover {
      transform: translateY(-10px) scale(1.03);
      border-color: #ff00ff;
      box-shadow: 
        0 0 40px rgba(255, 0, 255, 0.6),
        0 15px 40px rgba(0, 0, 0, 0.4);
    }

    .career-card.selected {
      border-color: #00ffff;
      border-width: 3px;
      transform: scale(1.08);
      box-shadow: 
        0 0 60px rgba(0, 255, 255, 0.8),
        0 20px 50px rgba(0, 0, 0, 0.5);
      animation: selectPulse 0.5s ease;
      background: rgba(0, 255, 255, 0.1);
    }

    @keyframes selectPulse {
      0%, 100% { transform: scale(1.08); }
      50% { transform: scale(1.12); }
    }

    .career-card.taken {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
      filter: grayscale(1);
    }

    /* Career Themes */
    .career-card[data-theme="doctor"] {
      background: linear-gradient(135deg, #e8f5f7 0%, #d4eef2 100%);
      border-color: #6dd5ed;
    }

    .career-card[data-theme="teacher"] {
      background: linear-gradient(135deg, #fff7e6 0%, #ffe8cc 100%);
      border-color: #ffa726;
    }

    .career-card[data-theme="programmer"] {
      background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
      border-color: #4299e1;
    }

    .career-card[data-theme="programmer"] .career-name,
    .career-card[data-theme="programmer"] .career-desc {
      color: #ffffff !important;
    }

    .career-card[data-theme="content-creator"] {
      background: linear-gradient(135deg, #ffe5f1 0%, #ffc9e3 100%);
      border-color: #ff6b9d;
    }

    .career-card[data-theme="salesperson"] {
      background: linear-gradient(135deg, #e6f7ff 0%, #ccedff 100%);
      border-color: #1890ff;
    }

    .career-card[data-theme="manager"] {
      background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
      border-color: #9c27b0;
    }

    .career-card[data-theme="businessperson"] {
      background: linear-gradient(135deg, #fff9e6 0%, #fff3cc 100%);
      border-color: #ffc107;
    }

    .career-icon {
      font-size: 56px;
      margin-bottom: 15px;
      display: block;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    .career-name {
      font-size: 22px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    .career-card.selected .career-name {
      color: #00ffff;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
    }

    .career-desc {
      font-size: 14px;
      color: #a0aec0;
      font-weight: 500;
    }

    .career-card.selected .career-desc {
      color: #ffffff;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    /* Home Screen */
    .home-screen {
      display: block;
      text-align: center;
    }

    .home-screen.hidden {
      display: none;
    }

    .welcome-icon {
      font-size: 120px;
      margin-bottom: 20px;
      animation: float 3s ease-in-out infinite;
    }

    .home-title {
      font-size: 48px;
      font-weight: 900;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 15px;
    }

    .home-description {
      font-size: 20px;
      color: #718096;
      margin-bottom: 40px;
      line-height: 1.6;
      font-weight: 500;
    }

    .game-features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .feature-card {
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
    }

    .feature-card:hover {
      transform: translateY(-5px);
      border-color: #667eea;
      box-shadow: 0 10px 25px rgba(102, 126, 234, 0.2);
    }

    .feature-icon {
      font-size: 40px;
      margin-bottom: 10px;
    }

    .feature-title {
      font-size: 18px;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 5px;
    }

    .feature-desc {
      font-size: 14px;
      color: #718096;
    }

    .start-button {
      width: 100%;
      padding: 22px;
      background: linear-gradient(135deg, #ff0080 0%, #ff00ff 50%, #00ffff 100%);
      background-size: 200% 200%;
      animation: buttonGradient 3s ease infinite;
      color: #ffffff;
      border: none;
      border-radius: 16px;
      font-size: 24px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 
        0 0 30px rgba(255, 0, 255, 0.6),
        0 8px 25px rgba(255, 0, 128, 0.4);
      text-transform: uppercase;
      letter-spacing: 3px;
      position: relative;
      overflow: hidden;
    }

    @keyframes buttonGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .start-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s ease;
    }

    .start-button:hover::before {
      left: 100%;
    }

    .start-button:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 
        0 0 50px rgba(255, 0, 255, 0.8),
        0 12px 40px rgba(255, 0, 128, 0.6);
    }

    .team-info {
      background: linear-gradient(135deg, #edf2f7 0%, #e2e8f0 100%);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 25px;
      text-align: center;
    }

    .team-label {
      font-size: 16px;
      color: #718096;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .team-name-display {
      font-size: 28px;
      font-weight: 800;
      color: #667eea;
      margin-bottom: 5px;
    }

    /* Team Name Input */
    .team-name-section {
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 25px;
    }

    .team-name-label {
      font-size: 18px;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 15px;
      text-align: center;
    }

    .team-name-input {
      width: 100%;
      padding: 15px;
      font-size: 18px;
      font-weight: 600;
      border: 3px solid #e2e8f0;
      border-radius: 10px;
      text-align: center;
      transition: all 0.3s ease;
      background: #ffffff;
      color: #2d3748;
    }

    .team-name-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }

    .team-counter {
      text-align: center;
      font-size: 16px;
      color: #718096;
      margin-top: 10px;
      font-weight: 600;
    }

    .confirm-button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      color: #ffffff;
      border: none;
      border-radius: 12px;
      font-size: 20px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(72, 187, 120, 0.3);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .confirm-button:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(72, 187, 120, 0.4);
    }

    .confirm-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Quiz Screen */
    .quiz-screen {
      display: none;
    }

    .quiz-screen.active {
      display: block;
    }

    .current-team-banner {
      background: linear-gradient(135deg, #ff0080 0%, #ff00ff 50%, #7928ca 100%);
      background-size: 200% 200%;
      animation: slideInRight 0.5s ease-out, bannerGradient 3s ease infinite;
      color: #ffffff;
      padding: 20px;
      border-radius: 20px;
      text-align: center;
      margin-bottom: 25px;
      box-shadow: 
        0 0 50px rgba(255, 0, 255, 0.6),
        0 10px 30px rgba(0, 0, 0, 0.4);
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    /* Game Host - Cat Character */
    .game-host {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 100;
      animation: hostFloat 3s ease-in-out infinite;
    }

    .host-character {
      font-size: 80px;
      filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.3));
      animation: hostBounce 2s ease-in-out infinite;
    }

    .host-speech-bubble {
      position: absolute;
      bottom: 100%;
      right: 0;
      background: white;
      color: #2d3748;
      padding: 12px 18px;
      border-radius: 16px;
      font-size: 14px;
      font-weight: 700;
      white-space: nowrap;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
      margin-bottom: 10px;
      display: none;
      animation: bubblePop 0.3s ease-out;
    }

    .host-speech-bubble.show {
      display: block;
    }

    .host-speech-bubble::after {
      content: '';
      position: absolute;
      bottom: -10px;
      right: 20px;
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-top: 10px solid white;
    }

    @keyframes hostFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }

    @keyframes hostBounce {
      0%, 100% { transform: scale(1) rotate(-5deg); }
      50% { transform: scale(1.1) rotate(5deg); }
    }

    @keyframes bubblePop {
      0% { transform: scale(0); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }

    /* Career Character Display */
    .character-display {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
      position: relative;
    }

    .career-character {
      font-size: 120px;
      animation: characterIdle 2s ease-in-out infinite;
      filter: drop-shadow(0 10px 25px rgba(0, 0, 0, 0.3));
      position: relative;
    }

    .character-display.sweating .career-character {
      animation: characterSweat 0.3s ease-in-out infinite;
    }

    .character-display.correct .career-character {
      animation: characterCelebrate 0.6s ease-in-out;
    }

    .character-display.wrong .career-character {
      animation: characterSad 0.6s ease-in-out;
    }

    @keyframes characterIdle {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-10px) rotate(3deg); }
    }

    @keyframes characterSweat {
      0%, 100% { transform: translateX(0) rotate(-2deg); }
      25% { transform: translateX(-5px) rotate(-5deg); }
      75% { transform: translateX(5px) rotate(5deg); }
    }

    @keyframes characterCelebrate {
      0%, 100% { transform: scale(1) rotate(0deg); }
      25% { transform: scale(1.2) rotate(-10deg); }
      50% { transform: scale(1.3) rotate(10deg); }
      75% { transform: scale(1.2) rotate(-5deg); }
    }

    @keyframes characterSad {
      0% { transform: translateY(0) rotate(0deg); }
      25% { transform: translateY(10px) rotate(-5deg); }
      50% { transform: translateY(5px) rotate(5deg); }
      75% { transform: translateY(15px) rotate(-3deg); }
      100% { transform: translateY(20px) rotate(0deg); }
    }

    /* Sweat Drops */
    .sweat-drop {
      position: absolute;
      font-size: 30px;
      animation: sweatFall 0.8s ease-in infinite;
      opacity: 0;
    }

    .sweat-drop:nth-child(1) {
      top: 20%;
      left: 30%;
      animation-delay: 0s;
    }

    .sweat-drop:nth-child(2) {
      top: 25%;
      right: 30%;
      animation-delay: 0.3s;
    }

    .sweat-drop:nth-child(3) {
      top: 35%;
      left: 25%;
      animation-delay: 0.6s;
    }

    @keyframes sweatFall {
      0% { opacity: 0; transform: translateY(0); }
      20% { opacity: 1; }
      100% { opacity: 0; transform: translateY(80px); }
    }

    /* Emotion Effects */
    .emotion-particle {
      position: absolute;
      font-size: 40px;
      animation: emotionFloat 1s ease-out forwards;
      pointer-events: none;
    }

    @keyframes emotionFloat {
      0% {
        opacity: 1;
        transform: translate(0, 0) scale(0.5);
      }
      100% {
        opacity: 0;
        transform: translate(var(--tx), var(--ty)) scale(1.5);
      }
    }

    @keyframes bannerGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .current-team-banner h2 {
      margin: 0 0 8px 0;
      font-size: 28px;
      font-weight: 800;
    }

    .current-team-banner p {
      margin: 0;
      font-size: 18px;
      opacity: 0.95;
    }

    .question-counter {
      text-align: center;
      font-size: 18px;
      color: #718096;
      margin-bottom: 20px;
      font-weight: 600;
    }

    /* Power-ups Section */
    .powerups-section {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .powerup-button {
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: #ffffff;
      border: none;
      border-radius: 10px;
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3);
    }

    .powerup-button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(251, 191, 36, 0.4);
    }

    .powerup-button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
      transform: none;
    }

    .powerup-button.used {
      background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
      opacity: 0.5;
    }

    /* Answer Timer */
    .discussion-timer {
      display: none;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: #ffffff;
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      margin-bottom: 20px;
      font-size: 20px;
      font-weight: 800;
      animation: timerPulse 1s ease-in-out infinite;
      transition: background 0.3s ease;
    }

    .discussion-timer.active {
      display: block;
    }

    .discussion-timer.warning {
      background: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%);
      animation: timerPulse 0.5s ease-in-out infinite;
    }

    .discussion-timer.danger {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      animation: timerPulse 0.3s ease-in-out infinite;
    }

    @keyframes timerPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .question-box {
      background: rgba(30, 30, 60, 0.8);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 25px;
      border: 2px solid rgba(255, 0, 255, 0.4);
      animation: slideInLeft 0.5s ease-out;
      box-shadow: 
        0 0 40px rgba(255, 0, 255, 0.3),
        0 10px 30px rgba(0, 0, 0, 0.3);
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .question-text {
      font-size: 24px;
      font-weight: 700;
      color: #ffffff;
      margin: 0;
      line-height: 1.5;
      text-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
    }

    .bonus-indicator {
      display: inline-block;
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: #ffffff;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 800;
      margin-left: 10px;
      animation: bonusPulse 1s ease-in-out infinite;
    }

    @keyframes bonusPulse {
      0%, 100% { transform: scale(1); box-shadow: 0 0 0 rgba(251, 191, 36, 0.7); }
      50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(251, 191, 36, 0.7); }
    }

    .answers-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 25px;
    }

    .answer-button {
      background: rgba(40, 40, 80, 0.6);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 0, 255, 0.3);
      border-radius: 16px;
      padding: 20px;
      font-size: 17px;
      font-weight: 600;
      color: #ffffff;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      position: relative;
      overflow: hidden;
    }

    .answer-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255, 0, 255, 0.2), rgba(0, 255, 255, 0.2));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .answer-button:hover::before {
      opacity: 1;
    }

    .answer-button:hover {
      border-color: #ff00ff;
      transform: translateX(8px);
      box-shadow: 0 0 30px rgba(255, 0, 255, 0.5);
    }

    .answer-button.selected {
      background: linear-gradient(135deg, #ff0080 0%, #ff00ff 50%, #00ffff 100%);
      background-size: 200% 200%;
      animation: answerGradient 2s ease infinite;
      border-color: #00ffff;
      border-width: 3px;
      color: #ffffff;
      transform: scale(1.03);
      box-shadow: 0 0 40px rgba(0, 255, 255, 0.6);
    }

    @keyframes answerGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .answer-button.correct {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      border-color: #48bb78;
      color: #ffffff;
      animation: correctPulse 0.6s ease;
    }

    .answer-button.wrong {
      background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
      border-color: #f56565;
      color: #ffffff;
      animation: wrongShake 0.5s ease;
    }

    .answer-button.eliminated {
      opacity: 0.3;
      pointer-events: none;
      text-decoration: line-through;
    }

    @keyframes correctPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes wrongShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    .submit-answer-button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #00ff88 0%, #00ffff 100%);
      background-size: 200% 200%;
      animation: submitGradient 2s ease infinite;
      color: #000000;
      border: none;
      border-radius: 16px;
      font-size: 20px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 
        0 0 30px rgba(0, 255, 255, 0.5),
        0 6px 20px rgba(0, 255, 136, 0.4);
      text-transform: uppercase;
      letter-spacing: 2px;
      position: relative;
      overflow: hidden;
    }

    @keyframes submitGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .submit-answer-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
      transition: left 0.5s ease;
    }

    .submit-answer-button:hover:not(:disabled)::before {
      left: 100%;
    }

    .submit-answer-button:hover:not(:disabled) {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 
        0 0 50px rgba(0, 255, 255, 0.8),
        0 10px 35px rgba(0, 255, 136, 0.6);
    }

    .submit-answer-button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      animation: none;
    }

    /* Live Leaderboard */
    .live-leaderboard {
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 25px;
      border: 2px solid #e2e8f0;
    }

    .leaderboard-title {
      font-size: 18px;
      font-weight: 800;
      color: #2d3748;
      margin-bottom: 15px;
      text-align: center;
    }

    .leaderboard-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .leaderboard-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 15px;
      background: #ffffff;
      border-radius: 8px;
      border: 2px solid #e2e8f0;
      transition: all 0.3s ease;
    }

    .leaderboard-item.current {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      transform: scale(1.02);
    }

    .leaderboard-team {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      color: #2d3748;
    }

    .leaderboard-rank {
      font-size: 18px;
      font-weight: 800;
      color: #667eea;
      min-width: 25px;
    }

    .leaderboard-score {
      font-size: 18px;
      font-weight: 800;
      color: #48bb78;
    }

    /* Scoreboard */
    .scoreboard-screen {
      display: none;
    }

    .scoreboard-screen.active {
      display: block;
    }

    .scoreboard-title {
      text-align: center;
      font-size: 38px;
      font-weight: 900;
      color: #2d3748;
      margin-bottom: 25px;
      animation: slideInUp 0.6s ease-out;
    }

    .awards-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .award-badge {
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: #ffffff;
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 6px 20px rgba(251, 191, 36, 0.3);
      animation: awardSlideIn 0.6s ease-out;
    }

    @keyframes awardSlideIn {
      from {
        opacity: 0;
        transform: scale(0.8);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .award-icon {
      font-size: 36px;
      margin-bottom: 8px;
    }

    .award-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .award-winner {
      font-size: 16px;
      font-weight: 800;
    }

    .scores-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 30px;
    }

    .score-item {
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      border: 3px solid #e2e8f0;
      border-radius: 16px;
      padding: 20px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
      animation: scoreSlideIn 0.5s ease-out;
    }

    @keyframes scoreSlideIn {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .score-item.rank-1 {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      border-color: #ffd700;
      transform: scale(1.05);
      box-shadow: 0 15px 40px rgba(255, 215, 0, 0.4);
      animation: winnerGlow 2s ease-in-out infinite;
    }

    @keyframes winnerGlow {
      0%, 100% { box-shadow: 0 15px 40px rgba(255, 215, 0, 0.4); }
      50% { box-shadow: 0 20px 50px rgba(255, 215, 0, 0.6); }
    }

    .score-item.rank-2 {
      background: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 100%);
      border-color: #c0c0c0;
      transform: scale(1.02);
    }

    .score-item.rank-3 {
      background: linear-gradient(135deg, #cd7f32 0%, #e8a87c 100%);
      border-color: #cd7f32;
    }

    .score-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .rank-badge {
      font-size: 28px;
      font-weight: 900;
      width: 50px;
      height: 50px;
      background: #667eea;
      color: #ffffff;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .score-item.rank-1 .rank-badge {
      background: #2d3748;
      font-size: 32px;
    }

    .score-item.rank-2 .rank-badge {
      background: #4a5568;
    }

    .score-item.rank-3 .rank-badge {
      background: #744210;
    }

    .team-details {
      display: flex;
      flex-direction: column;
    }

    .team-name-score {
      font-size: 22px;
      font-weight: 700;
      color: #2d3748;
    }

    .career-name-score {
      font-size: 15px;
      color: #718096;
      font-weight: 600;
    }

    .score-points {
      font-size: 32px;
      font-weight: 900;
      color: #667eea;
    }

    .score-item.rank-1 .score-points {
      color: #2d3748;
      font-size: 38px;
    }

    .winner-message {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      color: #ffffff;
      padding: 25px;
      border-radius: 16px;
      text-align: center;
      margin-bottom: 25px;
      font-size: 24px;
      font-weight: 700;
      box-shadow: 0 10px 30px rgba(72, 187, 120, 0.3);
      animation: winnerPulse 1.5s ease-in-out infinite;
    }

    @keyframes winnerPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    .fireworks {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
    }

    .firework {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: explode 1.5s ease-out forwards;
    }

    @keyframes explode {
      0% {
        transform: translate(0, 0) scale(1);
        opacity: 1;
      }
      100% {
        transform: translate(var(--tx), var(--ty)) scale(0);
        opacity: 0;
      }
    }

    .restart-game-button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
      border: none;
      border-radius: 12px;
      font-size: 20px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .restart-game-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }

    /* Lucky Boxes Screen */
    .lucky-boxes-screen {
      display: none;
    }

    .lucky-boxes-screen.active {
      display: block;
    }

    .lucky-banner {
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #ea580c 100%);
      background-size: 200% 200%;
      animation: bannerGradient 3s ease infinite;
      color: #ffffff;
      padding: 25px;
      border-radius: 20px;
      text-align: center;
      margin-bottom: 25px;
      box-shadow: 
        0 0 50px rgba(251, 191, 36, 0.6),
        0 10px 30px rgba(0, 0, 0, 0.4);
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .lucky-banner h2 {
      margin: 0 0 10px 0;
      font-size: 32px;
      font-weight: 900;
    }

    .lucky-banner p {
      margin: 0;
      font-size: 18px;
      opacity: 0.95;
    }

    .boxes-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 15px;
      margin-bottom: 25px;
    }

    .lucky-box {
      aspect-ratio: 1;
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.2) 0%, rgba(245, 158, 11, 0.2) 100%);
      backdrop-filter: blur(10px);
      border: 3px solid rgba(251, 191, 36, 0.4);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .lucky-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s ease;
    }

    .lucky-box:hover::before {
      left: 100%;
    }

    .lucky-box:hover {
      transform: translateY(-10px) scale(1.05);
      border-color: #fbbf24;
      box-shadow: 
        0 0 40px rgba(251, 191, 36, 0.8),
        0 15px 40px rgba(0, 0, 0, 0.4);
    }

    .lucky-box.opened {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
      filter: grayscale(1);
    }

    .box-icon {
      font-size: 48px;
      margin-bottom: 10px;
      animation: float 3s ease-in-out infinite;
    }

    .box-number {
      font-size: 20px;
      font-weight: 800;
      color: #fbbf24;
      text-shadow: 0 0 10px rgba(251, 191, 36, 0.8);
    }

    /* Lucky Box Result Modal */
    .lucky-result-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      z-index: 10000;
      align-items: center;
      justify-content: center;
    }

    .lucky-result-modal.show {
      display: flex;
    }

    .lucky-result-content {
      background: linear-gradient(135deg, rgba(20, 20, 40, 0.98) 0%, rgba(30, 30, 60, 0.98) 100%);
      backdrop-filter: blur(20px);
      border-radius: 32px;
      padding: 50px;
      max-width: 600px;
      width: 90%;
      text-align: center;
      border: 3px solid rgba(251, 191, 36, 0.5);
      box-shadow: 0 0 80px rgba(251, 191, 36, 0.6);
      animation: modalPopIn 0.5s ease-out;
    }

    @keyframes modalPopIn {
      from {
        opacity: 0;
        transform: scale(0.5);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .result-icon {
      font-size: 120px;
      margin-bottom: 20px;
      animation: iconSpin 1s ease-out;
    }

    @keyframes iconSpin {
      from {
        transform: rotate(0deg) scale(0);
      }
      to {
        transform: rotate(360deg) scale(1);
      }
    }

    .result-title {
      font-size: 36px;
      font-weight: 900;
      color: #fbbf24;
      margin-bottom: 15px;
      text-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
    }

    .result-description {
      font-size: 20px;
      color: #ffffff;
      margin-bottom: 30px;
      line-height: 1.6;
    }

    .result-action-button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color: #000000;
      border: none;
      border-radius: 16px;
      font-size: 20px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(251, 191, 36, 0.4);
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .result-action-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(251, 191, 36, 0.6);
    }

    /* Team Selector Modal */
    .team-selector-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      z-index: 10001;
      align-items: center;
      justify-content: center;
    }

    .team-selector-modal.show {
      display: flex;
    }

    .team-selector-content {
      background: linear-gradient(135deg, rgba(20, 20, 40, 0.98) 0%, rgba(30, 30, 60, 0.98) 100%);
      backdrop-filter: blur(20px);
      border-radius: 32px;
      padding: 40px;
      max-width: 600px;
      width: 90%;
      max-height: 80%;
      overflow-y: auto;
      border: 3px solid rgba(255, 0, 255, 0.5);
      box-shadow: 0 0 80px rgba(255, 0, 255, 0.6);
    }

    .team-selector-title {
      font-size: 28px;
      font-weight: 900;
      color: #00ffff;
      margin-bottom: 25px;
      text-align: center;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
    }

    .team-select-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .team-select-button {
      background: rgba(40, 40, 80, 0.6);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 0, 255, 0.3);
      border-radius: 16px;
      padding: 20px;
      font-size: 18px;
      font-weight: 700;
      color: #ffffff;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .team-select-button:hover {
      border-color: #ff00ff;
      transform: translateX(8px);
      box-shadow: 0 0 30px rgba(255, 0, 255, 0.5);
      background: linear-gradient(135deg, rgba(255, 0, 255, 0.2), rgba(0, 255, 255, 0.2));
    }

    /* Notification Toast */
    .notification-toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
      padding: 15px 25px;
      border-radius: 12px;
      font-weight: 700;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      z-index: 10000;
      animation: toastSlideIn 0.5s ease-out;
      display: none;
    }

    .notification-toast.show {
      display: block;
    }

    @keyframes toastSlideIn {
      from {
        opacity: 0;
        transform: translateX(100px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @media (max-width: 768px) {
      .game-card {
        padding: 25px;
      }

      .game-title {
        font-size: 32px;
      }

      .careers-grid {
        grid-template-columns: 1fr;
      }

      .answers-grid {
        grid-template-columns: 1fr;
      }

      .question-text {
        font-size: 20px;
      }

      .powerups-section {
        flex-direction: column;
      }

      .awards-section {
        grid-template-columns: 1fr;
      }

      .boxes-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .lucky-result-content {
        padding: 30px;
      }

      .result-icon {
        font-size: 80px;
      }

      .result-title {
        font-size: 28px;
      }

      .team-selector-content {
        padding: 25px;
      }
    }
  </style>
  <div class="background-pattern"></div>
  <div class="notification-toast" id="notificationToast"></div><!-- Game Host Cat -->
  <div class="game-host" id="gameHost">
   <div class="host-speech-bubble" id="hostSpeech"></div>
   <div class="host-character">
    üê±üé©
   </div>
  </div>
  <main class="game-container">
   <div class="game-card">
    <div class="game-header">
     <h1 class="game-title" id="gameTitle">üéÆ Career Path Quiz Game Pro</h1>
     <p class="game-subtitle" id="instructionText">7 Teams ‚Ä¢ 7 Careers ‚Ä¢ 5 Questions + Bonus</p>
    </div><!-- Home Screen -->
    <div class="home-screen" id="homeScreen">
     <div class="welcome-icon">
      üéØ
     </div>
     <h2 class="home-title">Welcome to Career Path Quiz!</h2>
     <p class="home-description">Test your knowledge across 7 different career paths.<br>
       Compete with your teams and become the champion!</p>
     <div class="game-features">
      <div class="feature-card">
       <div class="feature-icon">
        üë•
       </div>
       <div class="feature-title">
        7 Teams
       </div>
       <div class="feature-desc">
        Each team chooses their career
       </div>
      </div>
      <div class="feature-card">
       <div class="feature-icon">
        üíº
       </div>
       <div class="feature-title">
        7 Careers
       </div>
       <div class="feature-desc">
        Unique questions for each path
       </div>
      </div>
      <div class="feature-card">
       <div class="feature-icon">
        ‚ö°
       </div>
       <div class="feature-title">
        Power-ups
       </div>
       <div class="feature-desc">
        50/50 &amp; Double Points
       </div>
      </div>
      <div class="feature-card">
       <div class="feature-icon">
        ‚è±ÔøΩÔøΩ
       </div>
       <div class="feature-title">
        30 Seconds
       </div>
       <div class="feature-desc">
        Answer fast to score!
       </div>
      </div>
     </div><button class="start-button" onclick="goToTeamSetup()"> üöÄ Start Game </button>
    </div><!-- Team Selection Screen -->
    <div class="team-selection hidden" id="teamSelection">
     <div class="team-name-section">
      <div class="team-name-label">
       Enter Your Team Name:
      </div><input type="text" class="team-name-input" id="teamNameInput" placeholder="Type team name here..." maxlength="20" oninput="validateTeamName()">
      <div class="team-counter" id="teamCounter">
       Team 1 of 7
      </div>
     </div>
     <p class="selection-instruction">Choose your career path:</p>
     <div class="careers-grid" id="careersGrid"></div><button class="confirm-button" id="confirmButton" disabled onclick="confirmSelection()"> Start Quiz ‚Üí </button>
    </div><!-- Quiz Screen -->
    <div class="quiz-screen" id="quizScreen">
     <div class="current-team-banner">
      <h2 id="quizTeamName">Team 1</h2>
      <p id="quizCareerName">Doctor</p>
     </div><!-- Career Character Display -->
     <div class="character-display" id="characterDisplay">
      <div class="career-character" id="careerCharacter">
       üë®‚Äç‚öïÔ∏è
      </div>
     </div><!-- Live Leaderboard -->
     <div class="live-leaderboard">
      <div class="leaderboard-title">
       üìä Current Standings
      </div>
      <div class="leaderboard-list" id="leaderboardList"></div>
     </div><!-- Power-ups -->
     <div class="powerups-section"><button class="powerup-button" id="fiftyFiftyBtn" onclick="useFiftyFifty()"> ‚ö° 50/50 </button> <button class="powerup-button" id="doublePointsBtn" onclick="useDoublePoints()"> üíé Double Points </button>
     </div><!-- Answer Timer -->
     <div class="discussion-timer active" id="answerTimer">
      ‚è±Ô∏è Time Remaining: <span id="timerSeconds">30</span>s
     </div>
     <div class="question-counter" id="questionCounter">
      Question 1 of 5
     </div>
     <div class="question-box">
      <p class="question-text" id="questionText"></p>
     </div>
     <div class="answers-grid" id="answersGrid"></div><button class="submit-answer-button" id="submitButton" disabled onclick="submitAnswer()"> Submit Answer </button>
    </div><!-- Lucky Boxes Screen -->
    <div class="lucky-boxes-screen" id="luckyBoxesScreen">
     <div class="lucky-banner">
      <h2 id="luckyTeamName">üé∞ Team Name's Turn</h2>
      <p>Choose your lucky box wisely!</p>
     </div><!-- Live Leaderboard -->
     <div class="live-leaderboard">
      <div class="leaderboard-title">
       üìä Current Standings
      </div>
      <div class="leaderboard-list" id="luckyLeaderboardList"></div>
     </div>
     <div class="boxes-grid" id="boxesGrid"></div>
    </div><!-- Lucky Result Modal -->
    <div class="lucky-result-modal" id="luckyResultModal">
     <div class="lucky-result-content">
      <div class="result-icon" id="resultIcon"></div>
      <div class="result-title" id="resultTitle"></div>
      <div class="result-description" id="resultDescription"></div><button class="result-action-button" id="resultActionButton" onclick="closeResultModal()"> Continue </button>
     </div>
    </div><!-- Team Selector Modal -->
    <div class="team-selector-modal" id="teamSelectorModal">
     <div class="team-selector-content">
      <div class="team-selector-title" id="selectorTitle">
       Select a Team
      </div>
      <div class="team-select-list" id="teamSelectList"></div>
     </div>
    </div><!-- Scoreboard Screen -->
    <div class="scoreboard-screen" id="scoreboardScreen">
     <h2 class="scoreboard-title">üèÜ Final Results</h2>
     <div class="winner-message" id="winnerMessage"></div><!-- Awards Section -->
     <div class="awards-section" id="awardsSection"></div>
     <div class="scores-list" id="scoresList"></div><button class="restart-game-button" onclick="restartGame()"> üîÑ Play Again </button>
    </div>
   </div>
  </main>
  <div class="fireworks" id="fireworks"></div>
  <script>
    const defaultConfig = {
      game_title: "üéÆ Career Path Quiz Game Pro",
      instruction_text: "6 Teams ‚Ä¢ 6 Careers ‚Ä¢ 5 Questions + Bonus",
      winner_message: "üéâ Congratulations! You are the Winner! üéâ",
      discussion_time: "30",
      background_color: "#667eea",
      surface_color: "#ffffff",
      text_color: "#2d3748",
      primary_action_color: "#667eea",
      secondary_action_color: "#48bb78",
      font_family: "Nunito",
      font_size: 16
    };

    const careerThemes = {
      1: "doctor",
      2: "programmer",
      3: "content-creator",
      4: "salesperson",
      5: "manager",
      6: "businessperson"
    };

    const careers = [
      {
        id: 1,
        name: "Doctor",
        icon: "üë®‚Äç‚öïÔ∏è",
        description: "Healthcare Hero",
        questions: [
          {
            question: "If a patient complains of persistent headaches and dizziness, what should a doctor do first?",
            answers: ["Prescribe pain medication immediately", "Conduct a thorough examination and medical history", "Send them home to rest", "Recommend surgery right away"],
            correct: 1
          },
          {
            question: "What does 'diagnosis' mean in medical practice?",
            answers: ["Treating a disease", "Identifying an illness through examination", "Preventing future health problems", "Performing surgery on patients"],
            correct: 1
          },
          {
            question: "Why is continuing education important for doctors throughout their careers?",
            answers: ["To meet social expectations", "Medical knowledge and treatments constantly evolve", "It's required by hospital administrators", "To earn more money quickly"],
            correct: 1
          },
          {
            question: "What ethical principle requires doctors to maintain patient confidentiality?",
            answers: ["Medical privacy and trust", "Hospital regulations only", "Insurance requirements", "Legal punishment avoidance"],
            correct: 0
          },
          {
            question: "When should a doctor refer a patient to a specialist?",
            answers: ["Only when the patient requests it", "When the condition requires specialized expertise", "Never, doctors can treat everything", "Only in emergency situations"],
            correct: 1
          },
          {
            question: "BONUS: Which of these qualities is MOST essential for a successful medical career?",
            answers: ["Perfect memory for all medical facts", "Compassion combined with clinical expertise", "Ability to work without sleep", "Never showing emotion to patients"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 2,
        name: "Teacher",
        icon: "üë©‚ÄçÔøΩÔøΩÔøΩÔøΩ",
        description: "Knowledge Sharer",
        questions: [
          {
            question: "How should a teacher address diverse learning styles in the classroom?",
            answers: ["Use only one teaching method for consistency", "Incorporate visual, auditory, and hands-on activities", "Focus only on the fastest learners", "Ignore individual differences completely"],
            correct: 1
          },
          {
            question: "What does 'constructive feedback' mean in education?",
            answers: ["Only pointing out mistakes", "Criticism that helps students improve and grow", "Praising everything students do", "Avoiding any negative comments"],
            correct: 1
          },
          {
            question: "Why is classroom management crucial for effective teaching?",
            answers: ["It creates a productive learning environment", "It makes teachers look powerful", "Students will fear the teacher", "It's not really important"],
            correct: 0
          },
          {
            question: "What should a teacher do if a student is consistently struggling academically?",
            answers: ["Lower their expectations for that student", "Identify the root cause and provide additional support", "Ignore it and focus on other students", "Punish them for poor performance"],
            correct: 1
          },
          {
            question: "How can technology enhance modern teaching methods?",
            answers: ["It replaces the need for teachers", "It provides interactive and personalized learning experiences", "It's only useful for entertainment", "It makes teaching easier without effort"],
            correct: 1
          },
          {
            question: "BONUS: What is the most important factor in creating an inclusive classroom?",
            answers: ["Having expensive equipment", "Respecting and valuing every student's background and abilities", "Teaching only in English", "Focusing on test scores only"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 3,
        name: "Programmer",
        icon: "üë®‚Äçüíª",
        description: "Code Creator",
        questions: [
          {
            question: "What is the purpose of 'debugging' in software development?",
            answers: ["Creating new features quickly", "Identifying and fixing errors in code", "Making programs run slower", "Deleting unnecessary files"],
            correct: 1
          },
          {
            question: "Why is version control (like Git) essential for programmers?",
            answers: ["It makes code look professional", "It tracks changes and enables collaboration", "It's required by all companies", "It automatically fixes bugs"],
            correct: 1
          },
          {
            question: "What does 'scalability' mean in software design?",
            answers: ["Making the interface larger", "The ability to handle growing amounts of work", "Reducing program size", "Increasing profit margins"],
            correct: 1
          },
          {
            question: "When should a programmer refactor their code?",
            answers: ["Never, if it works don't change it", "When code becomes difficult to maintain or understand", "Only at the end of a project", "Every single day without exception"],
            correct: 1
          },
          {
            question: "What is the main benefit of using APIs in programming?",
            answers: ["They make programs more colorful", "They allow different software systems to communicate", "They automatically write code for you", "They eliminate the need for databases"],
            correct: 1
          },
          {
            question: "BONUS: Which programming principle helps create maintainable code?",
            answers: ["Writing the longest code possible", "DRY (Don't Repeat Yourself)", "Avoiding comments completely", "Using only one variable name"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 4,
        name: "Content Creator",
        icon: "üìπ",
        description: "Digital Storyteller",
        questions: [
          {
            question: "What does 'engagement rate' measure for content creators?",
            answers: ["How many hours they work daily", "How actively audiences interact with content", "The quality of camera equipment", "The number of competitors"],
            correct: 1
          },
          {
            question: "Why is consistency important for building an online audience?",
            answers: ["It helps establish trust and expectations", "It's required by social media platforms", "It guarantees viral content", "It's not actually important"],
            correct: 0
          },
          {
            question: "What should a content creator consider when collaborating with brands?",
            answers: ["Only the payment amount", "Brand alignment with their values and audience", "Taking every opportunity offered", "Ignoring audience feedback completely"],
            correct: 1
          },
          {
            question: "How can analytics tools help content creators improve their work?",
            answers: ["They automatically create content", "They provide insights into audience preferences and behavior", "They guarantee more followers instantly", "They replace the need for creativity"],
            correct: 1
          },
          {
            question: "What does 'content diversification' mean for a creator's strategy?",
            answers: ["Creating only one type of content", "Producing various content formats across platforms", "Copying other creators' ideas", "Posting randomly without planning"],
            correct: 1
          },
          {
            question: "BONUS: What is the biggest challenge for content creators in 2024?",
            answers: ["Finding a camera", "Standing out in a saturated market with authentic content", "Learning to read", "Avoiding the internet"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 5,
        name: "Salesperson",
        icon: "ü§ù",
        description: "Sales Expert",
        questions: [
          {
            question: "What is the purpose of 'building rapport' with potential customers?",
            answers: ["To manipulate them into buying", "To establish trust and positive relationships", "To waste time before selling", "To appear friendly without meaning it"],
            correct: 1
          },
          {
            question: "How should a salesperson handle objections from customers?",
            answers: ["Argue with them until they agree", "Listen carefully and address their concerns", "Give up immediately", "Pressure them into deciding quickly"],
            correct: 1
          },
          {
            question: "What does 'qualifying a lead' mean in sales?",
            answers: ["Giving them a certificate", "Determining if they're a potential customer", "Rejecting unimportant people", "Collecting their contact information"],
            correct: 1
          },
          {
            question: "Why is product knowledge crucial for successful salespeople?",
            answers: ["It helps answer questions and build credibility", "It makes them sound smart", "Customers never ask questions anyway", "It's only needed for technical products"],
            correct: 0
          },
          {
            question: "What is the difference between 'hard selling' and 'consultative selling'?",
            answers: ["One is difficult, one is easy", "Hard selling pushes products; consultative focuses on customer needs", "They are exactly the same approach", "Consultative selling is outdated"],
            correct: 1
          },
          {
            question: "BONUS: What is the most effective closing technique in modern sales?",
            answers: ["Pressuring for immediate decision", "Creating value and letting customers decide when ready", "Using aggressive tactics", "Offering unlimited discounts"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 6,
        name: "Manager",
        icon: "üëî",
        description: "Team Leader",
        questions: [
          {
            question: "What does 'delegation' mean in management?",
            answers: ["Doing all the work yourself", "Assigning tasks to team members appropriately", "Avoiding responsibilities completely", "Eliminating positions in the company"],
            correct: 1
          },
          {
            question: "How should a manager handle underperforming team members?",
            answers: ["Fire them immediately without discussion", "Provide feedback, support, and clear expectations", "Ignore the problem completely", "Publicly criticize them to others"],
            correct: 1
          },
          {
            question: "What is the purpose of setting SMART goals in management?",
            answers: ["To sound intelligent in meetings", "To create Specific, Measurable, Achievable, Relevant, Time-bound objectives", "To make goals impossible to reach", "To confuse team members"],
            correct: 1
          },
          {
            question: "Why is emotional intelligence important for managers?",
            answers: ["It helps them manipulate employees", "It enables understanding and managing team emotions effectively", "It's not relevant to management", "It only matters in personal life"],
            correct: 1
          },
          {
            question: "What should a manager prioritize when making strategic decisions?",
            answers: ["Personal preferences only", "Long-term company goals and team impact", "What's easiest at the moment", "Following every employee suggestion"],
            correct: 1
          },
          {
            question: "BONUS: What leadership style is most effective in modern workplaces?",
            answers: ["Authoritarian control", "Adaptive leadership that adjusts to team and situation", "Completely hands-off approach", "Micromanaging every detail"],
            correct: 1,
            isBonus: true
          }
        ]
      },
      {
        id: 7,
        name: "Businessperson",
        icon: "üíº",
        description: "Entrepreneur",
        questions: [
          {
            question: "What is a 'business model' and why is it important?",
            answers: ["A fashion trend in business", "A plan for how a company creates and delivers value", "A type of contract", "A building design for offices"],
            correct: 1
          },
          {
            question: "What does 'market research' help businesspeople understand?",
            answers: ["Only competitor prices", "Customer needs, trends, and market opportunities", "How to copy other businesses", "Stock market predictions only"],
            correct: 1
          },
          {
            question: "Why do many startups fail in their first few years?",
            answers: ["Bad luck only", "Poor planning, cash flow issues, or lack of market need", "Too much success too quickly", "Government regulations exclusively"],
            correct: 1
          },
          {
            question: "What does 'networking' mean in a business context?",
            answers: ["Installing computer systems", "Building professional relationships for mutual benefit", "Social media posting only", "Avoiding competition completely"],
            correct: 1
          },
          {
            question: "How should entrepreneurs respond to business failures?",
            answers: ["Give up immediately and never try again", "Learn from mistakes and adapt their approach", "Blame others for the problems", "Ignore what went wrong"],
            correct: 1
          },
          {
            question: "BONUS: What is the key to sustainable business growth?",
            answers: ["Rapid expansion at any cost", "Balancing growth with financial stability and customer satisfaction", "Copying successful competitors exactly", "Avoiding all risks completely"],
            correct: 1,
            isBonus: true
          }
        ]
      }
    ];

    // Lucky Boxes - Random events for Battle Royale
    const luckyBoxes = [
      {
        id: 1,
        icon: "üí∞",
        title: "Jackpot!",
        description: "Your team gets +50 points!",
        type: "add_points",
        points: 50
      },
      {
        id: 2,
        icon: "üíé",
        title: "Mega Bonus",
        description: "Your team gets +30 points!",
        type: "add_points",
        points: 30
      },
      {
        id: 3,
        icon: "‚ö°",
        title: "Power Up",
        description: "Your team gets +20 points!",
        type: "add_points",
        points: 20
      },
      {
        id: 4,
        icon: "üíÄ",
        title: "Penalty!",
        description: "Your team loses -30 points!",
        type: "subtract_points",
        points: 30
      },
      {
        id: 5,
        icon: "üò±",
        title: "Bad Luck",
        description: "Your team loses -20 points!",
        type: "subtract_points",
        points: 20
      },
      {
        id: 6,
        icon: "üîÑ",
        title: "Swap Scores",
        description: "Exchange points with another team!",
        type: "swap_points"
      },
      {
        id: 7,
        icon: "üéØ",
        title: "Steal Points",
        description: "Steal 25 points from any team!",
        type: "steal_points",
        points: 25
      },
      {
        id: 8,
        icon: "üéÅ",
        title: "Gift Points",
        description: "Give 15 points to another team (you also get +15)!",
        type: "gift_points",
        points: 15
      },
      {
        id: 9,
        icon: "üåü",
        title: "Double or Nothing",
        description: "50% chance: Double your score OR lose half!",
        type: "double_or_nothing"
      },
      {
        id: 10,
        icon: "üé≤",
        title: "Lucky Dice",
        description: "Roll the dice: +10, +20, +30, +40, or +50 points!",
        type: "random_points"
      }
    ];

    let teams = [];
    let currentTeamIndex = 0;
    let currentQuestionIndex = 0;
    let selectedAnswer = null;
    let teamScores = {};
    let powerups = {};
    let doublePointsActive = false;
    let answerTimerInterval = null;
    let fastestAnswerTeam = null;
    let fastestAnswerTime = Infinity;
    let questionStartTime = 0;
    let noMistakeTeams = [];
    let timeIsUp = false;
    let currentTeamName = '';
    let isBattleRoyaleMode = false;
    let battleRoyaleAnswers = {};
    let luckyBoxesOpened = [];
    let availableLuckyBoxes = [];
    let currentLuckyTeamIndex = 0;
    let pendingLuckyBoxAction = null;

    function initializeGame() {
      teams = [];
      currentTeamIndex = 0;
      currentQuestionIndex = 0;
      selectedAnswer = null;
      teamScores = {};
      powerups = {};
      doublePointsActive = false;
      fastestAnswerTeam = null;
      fastestAnswerTime = Infinity;
      noMistakeTeams = [];
      currentTeamName = '';
      isBattleRoyaleMode = false;
      battleRoyaleAnswers = {};
      luckyBoxesOpened = [];
      availableLuckyBoxes = [];
      currentLuckyTeamIndex = 0;
      pendingLuckyBoxAction = null;
      showScreen('homeScreen');
    }

    function goToTeamSetup() {
      currentTeamIndex = 0;
      currentTeamName = '';
      document.getElementById('teamNameInput').value = '';
      updateTeamCounter();
      renderCareersGrid();
      showScreen('teamSelection');
      document.getElementById('confirmButton').disabled = true;
      showHostMessage('Ch√†o m·ª´ng! H√£y ch·ªçn ngh·ªÅ nghi·ªáp!');
    }

    function validateTeamName() {
      const input = document.getElementById('teamNameInput');
      currentTeamName = input.value.trim();
      
      // Enable/disable confirm button based on both name and career selection
      const hasName = currentTeamName.length > 0;
      const hasCareer = selectedAnswer !== null;
      document.getElementById('confirmButton').disabled = !(hasName && hasCareer);
    }

    function updateTeamCounter() {
      document.getElementById('teamCounter').textContent = `Team ${currentTeamIndex + 1} of 7`;
    }

    function renderCareersGrid() {
      const grid = document.getElementById('careersGrid');
      grid.innerHTML = '';

      careers.forEach(career => {
        const isTaken = teams.some(t => t.careerId === career.id);
        const card = document.createElement('div');
        card.className = `career-card ${isTaken ? 'taken' : ''}`;
        card.setAttribute('data-theme', careerThemes[career.id]);
        card.innerHTML = `
          <span class="career-icon">${career.icon}</span>
          <div class="career-name">${career.name}</div>
          <div class="career-desc">${career.description}</div>
        `;
        
        if (!isTaken) {
          card.onclick = () => selectCareer(career.id, card);
        }
        
        grid.appendChild(card);
      });
    }

    function selectCareer(careerId, cardElement) {
      document.querySelectorAll('.career-card').forEach(c => c.classList.remove('selected'));
      cardElement.classList.add('selected');
      selectedAnswer = careerId;
      
      // Enable/disable confirm button based on both name and career selection
      const hasName = currentTeamName.length > 0;
      const hasCareer = selectedAnswer !== null;
      document.getElementById('confirmButton').disabled = !(hasName && hasCareer);
    }

    function confirmSelection() {
      if (selectedAnswer === null || currentTeamName.length === 0) return;

      const career = careers.find(c => c.id === selectedAnswer);
      
      teams.push({
        name: currentTeamName,
        careerId: career.id,
        careerName: career.name,
        careerIcon: career.icon,
        score: 0,
        mistakes: 0
      });

      teamScores[currentTeamName] = 0;
      powerups[currentTeamName] = {
        fiftyFifty: true,
        doublePoints: true
      };

      if (teams.length < 7) {
        currentTeamIndex++;
        selectedAnswer = null;
        currentTeamName = '';
        document.getElementById('teamNameInput').value = '';
        updateTeamCounter();
        renderCareersGrid();
        document.getElementById('confirmButton').disabled = true;
        document.getElementById('teamNameInput').focus();
        showNotification(`‚úÖ ${currentTeamName} registered successfully!`);
      } else {
        showNotification(`‚úÖ All teams ready! Starting quiz...`);
        startQuiz();
      }
    }

    function startQuiz() {
      currentTeamIndex = 0;
      currentQuestionIndex = 0;
      loadQuestion();
      showScreen('quizScreen');
    }

    function loadQuestion() {
      const team = teams[currentTeamIndex];
      const career = careers.find(c => c.id === team.careerId);
      const question = career.questions[currentQuestionIndex];

      document.getElementById('quizTeamName').textContent = team.name;
      document.getElementById('quizCareerName').textContent = `${team.careerIcon} ${team.careerName}`;
      
      // Update career character
      const characterDisplay = document.getElementById('characterDisplay');
      const careerCharacter = document.getElementById('careerCharacter');
      careerCharacter.textContent = team.careerIcon;
      characterDisplay.className = 'character-display';
      
      // Host cat speaks
      showHostMessage(getHostMessage('question_start'));
      
      const questionNum = currentQuestionIndex + 1;
      const totalQuestions = career.questions.length;
      document.getElementById('questionCounter').textContent = `Question ${questionNum} of ${totalQuestions}`;

      const questionTextEl = document.getElementById('questionText');
      questionTextEl.innerHTML = question.question;
      
      if (question.isBonus) {
        questionTextEl.innerHTML += ' <span class="bonus-indicator">‚≠ê BONUS +25pts</span>';
      }

      const answersGrid = document.getElementById('answersGrid');
      answersGrid.innerHTML = '';

      question.answers.forEach((answer, index) => {
        const button = document.createElement('button');
        button.className = 'answer-button';
        button.textContent = answer;
        button.onclick = () => selectAnswerOption(index, button);
        answersGrid.appendChild(button);
      });

      // Update power-up buttons
      const teamPowerups = powerups[team.name];
      document.getElementById('fiftyFiftyBtn').disabled = !teamPowerups.fiftyFifty;
      document.getElementById('doublePointsBtn').disabled = !teamPowerups.doublePoints;

      if (!teamPowerups.fiftyFifty) document.getElementById('fiftyFiftyBtn').classList.add('used');
      if (!teamPowerups.doublePoints) document.getElementById('doublePointsBtn').classList.add('used');

      updateLiveLeaderboard();
      
      selectedAnswer = null;
      timeIsUp = false;
      document.getElementById('submitButton').disabled = true;
      questionStartTime = Date.now();
      
      // Start 30-second timer
      startAnswerTimer();
    }

    function startAnswerTimer() {
      const answerTime = parseInt(window.elementSdk?.config?.discussion_time || defaultConfig.discussion_time);
      let timeLeft = answerTime;
      
      const timerEl = document.getElementById('answerTimer');
      const secondsEl = document.getElementById('timerSeconds');
      const characterDisplay = document.getElementById('characterDisplay');
      
      timerEl.classList.remove('warning', 'danger');
      timerEl.classList.add('active');
      secondsEl.textContent = timeLeft;

      if (answerTimerInterval) {
        clearInterval(answerTimerInterval);
      }

      answerTimerInterval = setInterval(() => {
        timeLeft--;
        secondsEl.textContent = timeLeft;
        
        // Change color based on time left
        if (timeLeft <= 10 && timeLeft > 5) {
          timerEl.classList.add('warning');
          timerEl.classList.remove('danger');
          showHostMessage('‚è∞ C√≤n 10 gi√¢y!');
        } else if (timeLeft <= 5) {
          timerEl.classList.add('danger');
          timerEl.classList.remove('warning');
          
          // Add sweating effect
          characterDisplay.classList.add('sweating');
          
          // Add sweat drops
          if (timeLeft === 5) {
            for (let i = 0; i < 3; i++) {
              const sweat = document.createElement('div');
              sweat.className = 'sweat-drop';
              sweat.textContent = 'üíß';
              characterDisplay.appendChild(sweat);
            }
          }
          
          if (timeLeft === 3) {
            showHostMessage('üò∞ Nhanh l√™n!');
          }
        }
        
        if (timeLeft <= 0) {
          clearInterval(answerTimerInterval);
          timeIsUp = true;
          characterDisplay.classList.remove('sweating');
          handleTimeUp();
        }
      }, 1000);
    }

    function handleTimeUp() {
      if (isBattleRoyaleMode) {
        showNotification('‚è∞ Time is up for Battle Royale! Revealing answers...');
        processAllBattleRoyaleAnswers();
        return;
      }

      showNotification('‚è∞ Time is up! No points awarded.');
      
      const team = teams[currentTeamIndex];
      const career = careers.find(c => c.id === team.careerId);
      const question = career.questions[currentQuestionIndex];
      const buttons = document.querySelectorAll('.answer-button');
      
      // Show correct answer
      buttons[question.correct].classList.add('correct');
      
      // Disable all buttons
      buttons.forEach(btn => btn.disabled = true);
      document.getElementById('submitButton').disabled = true;
      
      team.mistakes++;

      setTimeout(() => {
        if (currentQuestionIndex < career.questions.length - 1) {
          currentQuestionIndex++;
          loadQuestion();
        } else {
          if (team.mistakes === 0) {
            noMistakeTeams.push(team.name);
          }

          if (currentTeamIndex < teams.length - 1) {
            currentTeamIndex++;
            currentQuestionIndex = 0;
            loadQuestion();
          } else {
            startBattleRoyale();
          }
        }
      }, 2500);
    }

    function selectAnswerOption(index, buttonElement) {
      document.querySelectorAll('.answer-button').forEach(btn => {
        btn.classList.remove('selected');
      });
      buttonElement.classList.add('selected');
      selectedAnswer = index;
      document.getElementById('submitButton').disabled = false;
    }

    function useFiftyFifty() {
      const team = teams[currentTeamIndex];
      if (!powerups[team.name].fiftyFifty) return;

      const career = careers.find(c => c.id === team.careerId);
      const question = career.questions[currentQuestionIndex];
      const buttons = document.querySelectorAll('.answer-button');
      
      let eliminated = 0;
      buttons.forEach((btn, index) => {
        if (index !== question.correct && eliminated < 2) {
          btn.classList.add('eliminated');
          eliminated++;
        }
      });

      powerups[team.name].fiftyFifty = false;
      document.getElementById('fiftyFiftyBtn').disabled = true;
      document.getElementById('fiftyFiftyBtn').classList.add('used');
      
      showNotification('‚ö° 50/50 activated! 2 wrong answers eliminated');
    }

    function useDoublePoints() {
      const team = teams[currentTeamIndex];
      if (!powerups[team.name].doublePoints) return;

      doublePointsActive = true;
      powerups[team.name].doublePoints = false;
      document.getElementById('doublePointsBtn').disabled = true;
      document.getElementById('doublePointsBtn').classList.add('used');
      
      showNotification('üíé Double Points activated! This question is worth 2x points!');
    }

    function submitAnswer() {
      if (selectedAnswer === null || timeIsUp) return;

      // Stop the timer
      if (answerTimerInterval) {
        clearInterval(answerTimerInterval);
      }

      const team = teams[currentTeamIndex];
      const career = careers.find(c => c.id === team.careerId);
      const question = career.questions[currentQuestionIndex];
      const buttons = document.querySelectorAll('.answer-button');
      const characterDisplay = document.getElementById('characterDisplay');

      // Remove sweating effect
      characterDisplay.classList.remove('sweating');
      const sweatDrops = characterDisplay.querySelectorAll('.sweat-drop');
      sweatDrops.forEach(drop => drop.remove());

      const answerTime = Date.now() - questionStartTime;

      let pointsEarned = 0;

      if (selectedAnswer === question.correct) {
        buttons[selectedAnswer].classList.add('correct');
        
        // Happy character animation
        characterDisplay.classList.add('correct');
        createEmotionParticles('happy');
        showHostMessage(getHostMessage('correct'));
        
        pointsEarned = question.isBonus ? 25 : 15;
        if (doublePointsActive) {
          pointsEarned *= 2;
          showNotification(`üî• Correct! +${pointsEarned} points (Double Points!)`);
        } else {
          showNotification(`‚úÖ Correct! +${pointsEarned} points`);
        }
        
        team.score += pointsEarned;
        teamScores[team.name] += pointsEarned;

        // Track fastest answer
        if (answerTime < fastestAnswerTime) {
          fastestAnswerTime = answerTime;
          fastestAnswerTeam = team.name;
        }
      } else {
        buttons[selectedAnswer].classList.add('wrong');
        buttons[question.correct].classList.add('correct');
        
        // Sad character animation
        characterDisplay.classList.add('wrong');
        createEmotionParticles('sad');
        showHostMessage(getHostMessage('wrong'));
        
        team.mistakes++;
        showNotification('‚ùå Wrong answer!');
      }

      doublePointsActive = false;
      document.getElementById('submitButton').disabled = true;
      buttons.forEach(btn => btn.disabled = true);

      setTimeout(() => {
        if (currentQuestionIndex < career.questions.length - 1) {
          currentQuestionIndex++;
          loadQuestion();
        } else {
          // Track no-mistake teams
          if (team.mistakes === 0) {
            noMistakeTeams.push(team.name);
          }

          if (currentTeamIndex < teams.length - 1) {
            currentTeamIndex++;
            currentQuestionIndex = 0;
            loadQuestion();
          } else {
            startBattleRoyale();
          }
        }
      }, 2500);
    }

    function updateLiveLeaderboard() {
      const list = document.getElementById('leaderboardList');
      list.innerHTML = '';

      const sortedTeams = [...teams].sort((a, b) => b.score - a.score);
      const currentTeam = teams[currentTeamIndex];

      sortedTeams.forEach((team, index) => {
        const item = document.createElement('div');
        item.className = `leaderboard-item ${team.name === currentTeam.name ? 'current' : ''}`;
        item.innerHTML = `
          <div class="leaderboard-team">
            <span class="leaderboard-rank">${index + 1}</span>
            <span>${team.careerIcon} ${team.name}</span>
          </div>
          <div class="leaderboard-score">${team.score}</div>
        `;
        list.appendChild(item);
      });
    }

    function showScoreboard() {
      const sortedTeams = [...teams].sort((a, b) => b.score - a.score);
      const winner = sortedTeams[0];

      document.getElementById('winnerMessage').textContent = 
        `üéâ ${winner.name} (${winner.careerIcon} ${winner.careerName}) - Best Future Planner Award! üéâ`;

      // Show awards
      const awardsSection = document.getElementById('awardsSection');
      awardsSection.innerHTML = '';

      if (fastestAnswerTeam) {
        const fastAward = document.createElement('div');
        fastAward.className = 'award-badge';
        fastAward.innerHTML = `
          <div class="award-icon">ÔøΩÔøΩÔøΩ</div>
          <div class="award-title">Fastest Answer</div>
          <div class="award-winner">${fastestAnswerTeam}</div>
        `;
        awardsSection.appendChild(fastAward);
      }

      if (noMistakeTeams.length > 0) {
        noMistakeTeams.forEach(teamName => {
          const perfectAward = document.createElement('div');
          perfectAward.className = 'award-badge';
          perfectAward.innerHTML = `
            <div class="award-icon">üíØ</div>
            <div class="award-title">Perfect Score</div>
            <div class="award-winner">${teamName}</div>
          `;
          awardsSection.appendChild(perfectAward);
        });
      }

      const scoresList = document.getElementById('scoresList');
      scoresList.innerHTML = '';

      sortedTeams.forEach((team, index) => {
        const item = document.createElement('div');
        item.className = `score-item rank-${index + 1}`;
        item.style.animationDelay = `${index * 0.1}s`;
        item.innerHTML = `
          <div class="score-left">
            <div class="rank-badge">${index === 0 ? 'üèÜ' : index + 1}</div>
            <div class="team-details">
              <div class="team-name-score">${team.name}</div>
              <div class="career-name-score">${team.careerIcon} ${team.careerName}</div>
            </div>
          </div>
          <div class="score-points">${team.score}</div>
        `;
        scoresList.appendChild(item);
      });

      showScreen('scoreboardScreen');
      createFireworks();
    }

    function createFireworks() {
      const container = document.getElementById('fireworks');
      container.innerHTML = '';

      const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1', '#f093fb', '#4facfe'];

      for (let i = 0; i < 60; i++) {
        setTimeout(() => {
          const x = Math.random() * window.innerWidth;
          const y = Math.random() * window.innerHeight * 0.6;

          for (let j = 0; j < 12; j++) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            firework.style.background = colors[Math.floor(Math.random() * colors.length)];

            const angle = (j / 12) * Math.PI * 2;
            const velocity = 50 + Math.random() * 100;
            firework.style.setProperty('--tx', Math.cos(angle) * velocity + 'px');
            firework.style.setProperty('--ty', Math.sin(angle) * velocity + 'px');

            container.appendChild(firework);

            setTimeout(() => firework.remove(), 1500);
          }
        }, i * 150);
      }
    }

    function startBattleRoyale() {
      isBattleRoyaleMode = true;
      luckyBoxesOpened = [];
      availableLuckyBoxes = [...luckyBoxes];
      currentLuckyTeamIndex = 0;
      
      showNotification('üé∞ LUCKY BOXES TIME! Each team picks one box!');
      
      setTimeout(() => {
        startLuckyBoxRound();
      }, 3000);
    }

    function startLuckyBoxRound() {
      if (currentLuckyTeamIndex >= teams.length) {
        // All teams have picked, show final scoreboard
        showScoreboard();
        return;
      }

      const team = teams[currentLuckyTeamIndex];
      document.getElementById('luckyTeamName').textContent = `üé∞ ${team.careerIcon} ${team.name}'s Turn`;
      
      showHostMessage(getHostMessage('lucky_start'));
      
      updateLuckyLeaderboard();
      renderLuckyBoxes();
      showScreen('luckyBoxesScreen');
    }

    function renderLuckyBoxes() {
      const grid = document.getElementById('boxesGrid');
      grid.innerHTML = '';

      availableLuckyBoxes.forEach((box, index) => {
        const isOpened = luckyBoxesOpened.includes(box.id);
        const boxElement = document.createElement('div');
        boxElement.className = `lucky-box ${isOpened ? 'opened' : ''}`;
        boxElement.innerHTML = `
          <div class="box-icon">üéÅ</div>
          <div class="box-number">Box ${box.id}</div>
        `;
        
        if (!isOpened) {
          boxElement.onclick = () => openLuckyBox(box);
        }
        
        grid.appendChild(boxElement);
      });
    }

    function openLuckyBox(box) {
      luckyBoxesOpened.push(box.id);
      
      const currentTeam = teams[currentLuckyTeamIndex];
      
      // Show result modal
      document.getElementById('resultIcon').textContent = box.icon;
      document.getElementById('resultTitle').textContent = box.title;
      document.getElementById('resultDescription').textContent = box.description;
      
      // Process the box effect
      processLuckyBoxEffect(box, currentTeam);
      
      document.getElementById('luckyResultModal').classList.add('show');
    }

    function processLuckyBoxEffect(box, team) {
      pendingLuckyBoxAction = { box, team };
      
      switch(box.type) {
        case 'add_points':
          team.score += box.points;
          teamScores[team.name] += box.points;
          showNotification(`${team.name} gained +${box.points} points!`);
          break;
          
        case 'subtract_points':
          team.score = Math.max(0, team.score - box.points);
          teamScores[team.name] = Math.max(0, teamScores[team.name] - box.points);
          showNotification(`${team.name} lost -${box.points} points!`);
          break;
          
        case 'swap_points':
          // Will be handled when user selects a team
          break;
          
        case 'steal_points':
          // Will be handled when user selects a team
          break;
          
        case 'gift_points':
          // Will be handled when user selects a team
          team.score += box.points;
          teamScores[team.name] += box.points;
          break;
          
        case 'double_or_nothing':
          const chance = Math.random();
          if (chance < 0.5) {
            // Double the score
            const originalScore = team.score;
            team.score *= 2;
            teamScores[team.name] *= 2;
            document.getElementById('resultDescription').textContent = 
              `üéâ SUCCESS! Your score doubled from ${originalScore} to ${team.score}!`;
            showNotification(`${team.name} DOUBLED their score!`);
          } else {
            // Lose half
            const originalScore = team.score;
            team.score = Math.floor(team.score / 2);
            teamScores[team.name] = Math.floor(teamScores[team.name] / 2);
            document.getElementById('resultDescription').textContent = 
              `üíî UNLUCKY! Your score reduced from ${originalScore} to ${team.score}!`;
            showNotification(`${team.name} lost half their score!`);
          }
          break;
          
        case 'random_points':
          const randomPoints = [10, 20, 30, 40, 50][Math.floor(Math.random() * 5)];
          team.score += randomPoints;
          teamScores[team.name] += randomPoints;
          document.getElementById('resultDescription').textContent = 
            `üé≤ You rolled ${randomPoints} points!`;
          showNotification(`${team.name} rolled +${randomPoints} points!`);
          break;
      }
      
      updateLuckyLeaderboard();
    }

    function closeResultModal() {
      const action = pendingLuckyBoxAction;
      
      if (action && (action.box.type === 'swap_points' || action.box.type === 'steal_points' || action.box.type === 'gift_points')) {
        // Show team selector
        showTeamSelector(action.box.type);
      } else {
        document.getElementById('luckyResultModal').classList.remove('show');
        currentLuckyTeamIndex++;
        startLuckyBoxRound();
      }
    }

    function showTeamSelector(actionType) {
      document.getElementById('luckyResultModal').classList.remove('show');
      
      const currentTeam = teams[currentLuckyTeamIndex];
      const otherTeams = teams.filter(t => t.name !== currentTeam.name);
      
      let title = 'Select a Team';
      if (actionType === 'swap_points') title = 'üîÑ Swap Scores With:';
      if (actionType === 'steal_points') title = 'üéØ Steal Points From:';
      if (actionType === 'gift_points') title = 'üéÅ Give Points To:';
      
      document.getElementById('selectorTitle').textContent = title;
      
      const listEl = document.getElementById('teamSelectList');
      listEl.innerHTML = '';
      
      otherTeams.forEach(team => {
        const button = document.createElement('button');
        button.className = 'team-select-button';
        button.innerHTML = `
          <span>${team.careerIcon} ${team.name}</span>
          <span>${team.score} pts</span>
        `;
        button.onclick = () => selectTeamForAction(team, actionType);
        listEl.appendChild(button);
      });
      
      document.getElementById('teamSelectorModal').classList.add('show');
    }

    function selectTeamForAction(targetTeam, actionType) {
      const currentTeam = teams[currentLuckyTeamIndex];
      const action = pendingLuckyBoxAction;
      
      if (actionType === 'swap_points') {
        const tempScore = currentTeam.score;
        currentTeam.score = targetTeam.score;
        targetTeam.score = tempScore;
        
        teamScores[currentTeam.name] = currentTeam.score;
        teamScores[targetTeam.name] = targetTeam.score;
        
        showNotification(`${currentTeam.name} and ${targetTeam.name} swapped scores!`);
      } else if (actionType === 'steal_points') {
        const stolenPoints = Math.min(action.box.points, targetTeam.score);
        targetTeam.score -= stolenPoints;
        currentTeam.score += stolenPoints;
        
        teamScores[currentTeam.name] += stolenPoints;
        teamScores[targetTeam.name] -= stolenPoints;
        
        showNotification(`${currentTeam.name} stole ${stolenPoints} points from ${targetTeam.name}!`);
      } else if (actionType === 'gift_points') {
        targetTeam.score += action.box.points;
        teamScores[targetTeam.name] += action.box.points;
        
        showNotification(`${currentTeam.name} gifted ${action.box.points} points to ${targetTeam.name}!`);
      }
      
      document.getElementById('teamSelectorModal').classList.remove('show');
      updateLuckyLeaderboard();
      
      currentLuckyTeamIndex++;
      startLuckyBoxRound();
    }

    function updateLuckyLeaderboard() {
      const list = document.getElementById('luckyLeaderboardList');
      list.innerHTML = '';

      const sortedTeams = [...teams].sort((a, b) => b.score - a.score);
      const currentTeam = teams[currentLuckyTeamIndex];

      sortedTeams.forEach((team, index) => {
        const item = document.createElement('div');
        item.className = `leaderboard-item ${currentTeam && team.name === currentTeam.name ? 'current' : ''}`;
        item.innerHTML = `
          <div class="leaderboard-team">
            <span class="leaderboard-rank">${index + 1}</span>
            <span>${team.careerIcon} ${team.name}</span>
          </div>
          <div class="leaderboard-score">${team.score}</div>
        `;
        list.appendChild(item);
      });
    }



    function showNotification(message) {
      const toast = document.getElementById('notificationToast');
      toast.textContent = message;
      toast.classList.add('show');

      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    function showHostMessage(message) {
      const hostSpeech = document.getElementById('hostSpeech');
      hostSpeech.textContent = message;
      hostSpeech.classList.add('show');

      setTimeout(() => {
        hostSpeech.classList.remove('show');
      }, 3000);
    }

    function getHostMessage(type) {
      const messages = {
        question_start: ['C√¢u h·ªèi m·ªõi ƒë√¢y!', 'S·∫µn s√†ng ch∆∞a?', 'Ch√∫c may m·∫Øn!', 'H√£y th·ª≠ s·ª©c nh√©!'],
        correct: ['Tuy·ªát v·ªùi! üéâ', 'Ch√≠nh x√°c! ‚ú®', 'Gi·ªèi qu√°! üí™', 'Xu·∫•t s·∫Øc! üåü'],
        wrong: ['√îi kh√¥ng! üòø', 'Ti·∫øc qu√°!', 'Sai r·ªìi...', 'L·∫ßn sau s·∫Ω ƒë√∫ng!'],
        lucky_start: ['Ch·ªçn h·ªôp may m·∫Øn!', 'V·∫≠n may ƒëang ch·ªù!', 'H·ªôp n√†o nh·ªâ?', 'H√£y ch·ªçn ƒëi!'],
        game_start: ['B·∫Øt ƒë·∫ßu th√¥i! üéÆ', 'Tr√≤ ch∆°i b·∫Øt ƒë·∫ßu!', 'Ch√∫c vui v·∫ª!']
      };

      const messageArray = messages[type] || messages.question_start;
      return messageArray[Math.floor(Math.random() * messageArray.length)];
    }

    function createEmotionParticles(emotion) {
      const characterDisplay = document.getElementById('characterDisplay');
      const emojis = emotion === 'happy' ? ['‚ù§Ô∏è', '‚≠ê', '‚ú®', 'üéâ', 'üíØ'] : ['üíî', 'üò¢', 'üò≠', 'üíß'];
      
      for (let i = 0; i < 8; i++) {
        setTimeout(() => {
          const particle = document.createElement('div');
          particle.className = 'emotion-particle';
          particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
          
          const angle = (i / 8) * Math.PI * 2;
          const distance = 80 + Math.random() * 40;
          particle.style.setProperty('--tx', Math.cos(angle) * distance + 'px');
          particle.style.setProperty('--ty', Math.sin(angle) * distance + 'px');
          
          particle.style.left = '50%';
          particle.style.top = '50%';
          
          characterDisplay.appendChild(particle);
          
          setTimeout(() => particle.remove(), 1000);
        }, i * 50);
      }
    }

    function showScreen(screenName) {
      document.getElementById('homeScreen').classList.add('hidden');
      document.getElementById('teamSelection').classList.add('hidden');
      document.getElementById('quizScreen').classList.remove('active');
      document.getElementById('luckyBoxesScreen').classList.remove('active');
      document.getElementById('scoreboardScreen').classList.remove('active');

      if (screenName === 'homeScreen') {
        document.getElementById('homeScreen').classList.remove('hidden');
      }

      if (screenName === 'teamSelection') {
        document.getElementById('teamSelection').classList.remove('hidden');
      }

      if (screenName === 'quizScreen') {
        document.getElementById('quizScreen').classList.add('active');
      }

      if (screenName === 'luckyBoxesScreen') {
        document.getElementById('luckyBoxesScreen').classList.add('active');
      }

      if (screenName === 'scoreboardScreen') {
        document.getElementById('scoreboardScreen').classList.add('active');
      }
    }

    function restartGame() {
      document.getElementById('fireworks').innerHTML = '';
      initializeGame();
    }

    async function onConfigChange(config) {
      const gameTitle = document.getElementById('gameTitle');
      const instructionText = document.getElementById('instructionText');

      if (gameTitle) {
        gameTitle.textContent = config.game_title || defaultConfig.game_title;
      }

      if (instructionText) {
        instructionText.textContent = config.instruction_text || defaultConfig.instruction_text;
      }

      const backgroundColor = config.background_color || defaultConfig.background_color;
      const surfaceColor = config.surface_color || defaultConfig.surface_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const primaryColor = config.primary_action_color || defaultConfig.primary_action_color;
      const secondaryColor = config.secondary_action_color || defaultConfig.secondary_action_color;

      document.body.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${backgroundColor}dd 100%)`;

      const gameCard = document.querySelector('.game-card');
      if (gameCard) {
        gameCard.style.background = surfaceColor;
      }

      const textElements = document.querySelectorAll('.game-title, .question-text, .team-name-score, .scoreboard-title');
      textElements.forEach(el => {
        el.style.color = textColor;
      });

      const primaryButtons = document.querySelectorAll('.submit-answer-button, .restart-game-button, .current-team-banner, .rank-badge');
      primaryButtons.forEach(btn => {
        btn.style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${primaryColor}dd 100%)`;
      });

      const secondaryButtons = document.querySelectorAll('.confirm-button, .winner-message');
      secondaryButtons.forEach(btn => {
        btn.style.background = `linear-gradient(135deg, ${secondaryColor} 0%, ${secondaryColor}dd 100%)`;
      });

      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontSize = config.font_size || defaultConfig.font_size;
      const baseFontStack = 'Nunito, Segoe UI, sans-serif';

      document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;

      if (gameTitle) {
        gameTitle.style.fontSize = `${baseFontSize * 2.625}px`;
      }

      if (instructionText) {
        instructionText.style.fontSize = `${baseFontSize * 1.125}px`;
      }

      const questionTexts = document.querySelectorAll('.question-text');
      questionTexts.forEach(el => {
        el.style.fontSize = `${baseFontSize * 1.5}px`;
      });

      const answerButtons = document.querySelectorAll('.answer-button');
      answerButtons.forEach(el => {
        el.style.fontSize = `${baseFontSize * 1.0625}px`;
      });
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.surface_color || defaultConfig.surface_color,
              set: (value) => {
                config.surface_color = value;
                window.elementSdk.setConfig({ surface_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.primary_action_color || defaultConfig.primary_action_color,
              set: (value) => {
                config.primary_action_color = value;
                window.elementSdk.setConfig({ primary_action_color: value });
              }
            },
            {
              get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
              set: (value) => {
                config.secondary_action_color = value;
                window.elementSdk.setConfig({ secondary_action_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["game_title", config.game_title || defaultConfig.game_title],
          ["instruction_text", config.instruction_text || defaultConfig.instruction_text],
          ["winner_message", config.winner_message || defaultConfig.winner_message],
          ["discussion_time", config.discussion_time || defaultConfig.discussion_time]
        ])
      });
    }

    initializeGame();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a49fa80e63d91c3',t:'MTc2NDE2NjMyNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
